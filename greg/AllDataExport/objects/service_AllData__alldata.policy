<?xml version="1.0" encoding="UTF-8"?><exp:Export xmlns:exp="http://www.layer7tech.com/ws/policy/export" xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy" Version="3.0">
    <exp:References>
        <IncludedPolicyReference RefType="com.l7tech.console.policy.exporter.IncludedPolicyReference" guid="75d640da-2c2d-4880-810d-d1696e4c078a" included="true" name="Handle Auth" soap="false" type="INCLUDE_FRAGMENT">
            <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
                <wsp:All wsp:Usage="Required">
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="Policy Fragment: Handle Auth"/>
                    </L7p:AuditDetailAssertion>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue=""/>
                        <L7p:VariableToSet stringValue="auth_status"/>
                    </L7p:SetVariable>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.method}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="GET"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:Encapsulated>
                                <L7p:EncapsulatedAssertionConfigGuid stringValue="mag393bcb93-82ad-4b55-8333-1119f607a"/>
                                <L7p:EncapsulatedAssertionConfigName stringValue="mag OTK Require OAuth 2.0 Token"/>
                                <L7p:Parameters mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="cache_lifetime"/>
                                    <L7p:value stringValue="30"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="given_access_token"/>
                                    <L7p:value stringValue=""/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="onetime"/>
                                    <L7p:value stringValue="false"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="scope_fail"/>
                                    <L7p:value stringValue="false"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="scope_required"/>
                                    <L7p:value stringValue=""/>
                                    </L7p:entry>
                                </L7p:Parameters>
                            </L7p:Encapsulated>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValueReference="inline"><![CDATA[CLIENTID: ${session.client_id}
SUBSCRIBERID: ${session.subscriber_id}]]></L7p:Detail>
                                <L7p:Level stringValue="WARNING"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="U3VjY2Vzcw=="/>
                                <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                            </L7p:HardcodedResponse>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Check for existing Access Token"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.method}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="POST"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.resetPassword}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="Submit"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.password}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="${request.http.parameter.confirmPassword}"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnBhc3N3b3JkfQ=="/>
                                <L7p:VariableToSet stringValue="newPassword"/>
                            </L7p:SetVariable>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="request.http.parameter.sessionID"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="userid"/>
                                <L7p:TransformType transformType="URL_DECODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="userid"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="userid"/>
                                <L7p:TransformType transformType="BASE64_DECODE"/>
                            </L7p:EncodeDecode>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValueReference="inline"><![CDATA[USER ID: ${userid}
NEW PASS: ${newPassword}]]></L7p:Detail>
                                <L7p:Level stringValue="WARNING"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:Regex>
                                <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// password must be at least 8 characters and contain letters and numbers"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:AssertionComment>
                                <L7p:AutoTarget booleanValue="false"/>
                                <L7p:OtherTargetMessageVariable stringValue="newPassword"/>
                                <L7p:Regex stringValue="^(?=.*\d)(?=.*[a-zA-Z]).{8,}$"/>
                                <L7p:Replacement stringValue=""/>
                                <L7p:Target target="OTHER"/>
                            </L7p:Regex>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="cGFzc3dvcmQgY2hhbmdlZDogJHtuZXdQYXNzd29yZH0="/>
                                <L7p:EarlyResponse booleanValue="true"/>
                                <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                            </L7p:HardcodedResponse>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Handle Password Reset"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.method}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="POST"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnVzZXJuYW1lfQ=="/>
                                <L7p:VariableToSet stringValue="userid"/>
                            </L7p:SetVariable>
                            <L7p:HttpRoutingAssertion>
                                <L7p:FailOnErrorStatus booleanValue="false"/>
                                <L7p:ProtectedServiceUrl stringValue="https://explore.layer7.ca:8443/mag/auth/oauth/v2/authorize"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:SamlAssertionVersion intValue="2"/>
                            </L7p:HttpRoutingAssertion>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValueReference="inline"><![CDATA[CODE: ${httpRouting.reasonCode}
LOC: ${response.http.header.location}
RESP: ${response.mainpart}]]></L7p:Detail>
                                <L7p:Level stringValue="WARNING"/>
                            </L7p:AuditDetailAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${httpRouting.reasonCode}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="302"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:Split>
                                    <L7p:InputVariable stringValue="response.http.header.location"/>
                                    <L7p:OutputVariable stringValue="respParams"/>
                                    <L7p:SplitPattern stringValue="\?|&amp;"/>
                                    </L7p:Split>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="code"/>
                                    </L7p:SetVariable>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="state"/>
                                    </L7p:SetVariable>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="auth"/>
                                    </L7p:SetVariable>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="RESPPARAMS: ${respParams}"/>
                                    <L7p:Level stringValue="WARNING"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:ForEachLoop L7p:Usage="Required" iterationLimit="10" loopVariable="respParams" variablePrefix="itr">
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>

                                    <L7p:OtherTargetMessageVariable stringValue="itr.current"/>
                                    <L7p:Regex stringValue="code="/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtpdHIuY3VycmVudH0="/>
                                    <L7p:VariableToSet stringValue="code"/>
                                    </L7p:SetVariable>
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>

                                    <L7p:OtherTargetMessageVariable stringValue="code"/>
                                    <L7p:Regex stringValue="code="/>
                                    <L7p:Replace booleanValue="true"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>

                                    <L7p:OtherTargetMessageVariable stringValue="itr.current"/>
                                    <L7p:Regex stringValue="state="/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtpdHIuY3VycmVudH0="/>
                                    <L7p:VariableToSet stringValue="state"/>
                                    </L7p:SetVariable>
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>

                                    <L7p:OtherTargetMessageVariable stringValue="state"/>
                                    <L7p:Regex stringValue="state="/>
                                    <L7p:Replace booleanValue="true"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>

                                    <L7p:OtherTargetMessageVariable stringValue="itr.current"/>
                                    <L7p:Regex stringValue="auth="/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtpdHIuY3VycmVudH0="/>
                                    <L7p:VariableToSet stringValue="auth"/>
                                    </L7p:SetVariable>
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>

                                    <L7p:OtherTargetMessageVariable stringValue="auth"/>
                                    <L7p:Regex stringValue="auth="/>
                                    <L7p:Replace booleanValue="true"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    </wsp:All>
                                    <L7p:TrueAssertion/>
                                    </wsp:OneOrMore>
                                    </L7p:ForEachLoop>
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${state}"/>
                                    <L7p:Expression2 stringValue="call"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="call"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${auth}"/>
                                    <L7p:Expression2 stringValue="done"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="done"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${code}"/>
                                    <L7p:Expression2 stringValue=""/>
                                    <L7p:Negate booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Include>
                                    <L7p:PolicyGuid stringValue="85c086c7-6d37-44d7-8244-7b812f85ee9b"/>
                                    </L7p:Include>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="PASSWORD EXPIRED: ${passwordExpired}"/>
                                    <L7p:Level stringValue="WARNING"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Check Password Age Policy"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Include>
                                    <L7p:PolicyGuid stringValue="cdfe58f1-5bf6-4893-b6b6-0be6c736ac9b"/>
                                    </L7p:Include>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${accountStatus}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="active"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="WW91ciBhY2NvdW50IGlzIG5vdCBhdXRob3JpemVk"/>
                                    <L7p:EarlyResponse booleanValue="true"/>

                                    <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="403"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Account Valid Check"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Include>
                                    <L7p:PolicyGuid stringValue="8e1d00e2-f87e-4492-82d3-02364932085d"/>
                                    </L7p:Include>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// License Check"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:All>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:WssReplayProtection>
                                    <L7p:CustomExpiryTime intValue="300000"/>

                                    <L7p:CustomIdentifierVariable stringValue="code"/>
                                    <L7p:CustomProtection booleanValue="true"/>
                                    <L7p:CustomScope stringValue="myendpoiint"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    </L7p:WssReplayProtection>
                                    <L7p:EncodeDecode>
                                    <L7p:SourceVariableName stringValue="redirect_uri"/>
                                    <L7p:TargetDataType variableDataType="string"/>
                                    <L7p:TargetVariableName stringValue="redirect_uri_encoded"/>
                                    <L7p:TransformType transformType="URL_ENCODE"/>
                                    </L7p:EncodeDecode>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="cmVkaXJlY3RfdXJpPSR7cmVkaXJlY3RfdXJpX2VuY29kZWR9JmNvZGU9JHtjb2RlfSZncmFudF90eXBlPWF1dGhvcml6YXRpb25fY29kZSZzdGF0ZT0ke2dhdGV3YXkudGltZS55eXl5TU1kZEhIbW1zc1NTU30mY2xpZW50X2lkPSR7Y2xpZW50X2lkfSZjbGllbnRfc2VjcmV0PSR7Y2xpZW50X3NlY3JldH0="/>
                                    <L7p:ContentType stringValue="application/x-www-form-urlencoded"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="toServer"/>
                                    </L7p:SetVariable>
                                    <L7p:HttpRoutingAssertion>
                                    <L7p:FailOnErrorStatus booleanValue="false"/>
                                    <L7p:HttpMethod httpMethod="POST"/>
                                    <L7p:ProtectedServiceUrl stringValue="https://explore.layer7.ca:8443/mag/auth/oauth/v2/token"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestMsgSrc stringValue="toServer"/>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="authServerResponse"/>

                                    <L7p:SamlAssertionVersion intValue="2"/>
                                    </L7p:HttpRoutingAssertion>
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:CaptureVar stringValue="access_token"/>

                                    <L7p:OtherTargetMessageVariable stringValue="authServerResponse"/>
                                    <L7p:Regex stringValue="\&quot;access_token\&quot;:\&quot;([^&quot;]{1,60})\&quot;"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHthY2Nlc3NfdG9rZW5bMV19"/>
                                    <L7p:VariableToSet stringValue="access_token"/>
                                    </L7p:SetVariable>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:CaptureVar stringValue="refresh_token"/>

                                    <L7p:OtherTargetMessageVariable stringValue="authServerResponse"/>
                                    <L7p:Regex stringValue="\&quot;refresh_token\&quot;:\&quot;([^&quot;]{1,60})\&quot;"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtyZWZyZXNoX3Rva2VuWzFdfQ=="/>

                                    <L7p:VariableToSet stringValue="refresh_token"/>
                                    </L7p:SetVariable>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="PGJyLz4NCjxoci8+DQo8cD48Yj5SZWZyZXNoPC9iPjwvcD4NCjxwPlVzZSB0aGUgcmVmcmVzaF90b2tlbiB0byByZXF1ZXN0IGEgbmV3IGFjY2Vzc190b2tlbiBhbmQgcmVmcmVzaF90b2tlbjxici8+KGl0IGNhbm5vdCBiZSBleGNoYW5nZWQgZm9yIGEgbmV3IGlkX3Rva2VuKTwvcD4NCjxwPlRoZSBjbGllbnQgbmVlZHMgdG8gaW5jbHVkZSB0aGUgcGFyYW1ldGVycyBsaXN0ZWQgYmVsb3cuIEl0IGFsc28gbmVlZHMgdG8gYXV0aGVudGljYXRlIGl0c2VsZiB1c2luZyBjbGllbnRfaWQgYW5kIGNsaWVudF9zZWNyZXQuPC9wPg0KPGZvcm0gYWN0aW9uPSIke2xvY2F0aW9uX2FwcH0iIG1ldGhvZD0iUE9TVCI+DQogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhdGUiIHZhbHVlPSJyZWZyZXNoIj48YnIvPg0KPHRhYmxlPg0KPHRyPiAgICANCjx0ZD5yZWZyZXNoX3Rva2VuPC90ZD48dGQ+PGlucHV0IHR5cGU9InRleHQiIG5hbWU9InJlZnJlc2hfdG9rZW4iIHZhbHVlPSIke3JlZnJlc2hfdG9rZW59IiByZWFkb25seT0icmVhZG9ubHkiPjwvdGQ+DQo8L3RyPg0KPHRyPg0KPHRkPmdyYW50X3R5cGU8L3RkPjx0ZD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0iZ3JhbnRfdHlwZSIgdmFsdWU9InJlZnJlc2hfdG9rZW4iIHJlYWRvbmx5PSJyZWFkb25seSI+PC90ZD4NCjwvdHI+DQo8dHI+DQo8dGQ+c2NvcGU8L3RkPjx0ZD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0ic2NvcGUiIHZhbHVlPSIke3Njb3BlfSIgcmVhZG9ubHk9InJlYWRvbmx5Ij48L3RkPg0KPC90cj4NCjx0cj4NCjx0ZD5Vc2UgdGhlIHJlZnJlc2hfdG9rZW48L3RkPjx0ZD48aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iUmVmcmVzaCI+PC90ZD4NCjwvdHI+DQo8L3RhYmxlPg0KPC9mb3JtPg0KPGJyLz4="/>

                                    <L7p:VariableToSet stringValue="refresh_token_display"/>
                                    </L7p:SetVariable>
                                    </wsp:All>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="refresh_token_display"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Check for a refresh_token"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:OneOrMore>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:CaptureVar stringValue="id_token"/>

                                    <L7p:OtherTargetMessageVariable stringValue="authServerResponse"/>
                                    <L7p:Regex stringValue="\&quot;id_token\&quot;:\&quot;([^&quot;]+)\&quot;"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtpZF90b2tlblsxXX0="/>

                                    <L7p:VariableToSet stringValue="id_token"/>
                                    </L7p:SetVariable>
                                    <L7p:JwtDecode>

                                    <L7p:AlgorithmSecretLocation intValue="4"/>

                                    <L7p:AlgorithmSecretValue stringValue="${client_secret_bcp}"/>

                                    <L7p:IncomingToken stringValue="${id_token}"/>

                                    <L7p:OutputVariable stringValue="jwt.payload"/>
                                    </L7p:JwtDecode>
                                    <L7p:IDTokenDecode>
                                    <L7p:Payload stringValue="${jwt.payload}"/>
                                    </L7p:IDTokenDecode>
                                    </wsp:All>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="PHA+PGI+Tm8gSURfVE9LRU4gd2FzIGlzc3VlZDwvYj4uIFRoZXJlIGFyZSBzZXZlcmFsIHBvc3NpYmxlIHJlYXNvbnMgZm9yIHRoYXQ6PC9wPg0KPG9sPg0KPGxpPnRoZSB1c2VyIGRpZCBub3QgZ3JhbnQgaXQ8L2xpPg0KPGxpPnRoZSByZXF1ZXN0ZWQgU0NPUEUgZGlkIG5vdCBpbmNsdWRlICdvcGVuaWQnPC9saT4NCjxsaT50aGUgY2xpZW50IHdhcyBub3QgcmVnaXN0ZXJlZCBhcyBhIHZhbGlkIE9wZW5JRCBDb25uZWN0IGNsaWVudDwvbGk+DQo8bGk+YSByZWZyZXNoX3Rva2VuIHdhcyB1c2VkIHRvIHJlcXVlc3QgbmV3IHRva2VucyBidXQgYSByZWZyZXNoX3Rva2VuIGNhbm5vdCBiZSB1c2VkIHRvIHJlcXVlc3QgYSBuZXcgaWRfdG9rZW48L2xpPg0KPC9vbD4="/>
                                    <L7p:VariableToSet stringValue="idTokenIssued"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Check for an id_token"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:OneOrMore>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="c3VjY2Vzcwoke2FjY2Vzc190b2tlbn0KJHtpZF90b2tlbn0="/>
                                    <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="VW5hYmxlIHRvIHJldHJpZXZlIGFjY2VzcyB0b2tlbg=="/>
                                    <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="403"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Exchange Auth Code for Access Token"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:OneOrMore>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Successful Authentication"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                                <wsp:All wsp:Usage="Required">
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="ZmFpbGVk"/>
                                    <L7p:VariableToSet stringValue="auth_status"/>
                                    </L7p:SetVariable>
                                    <L7p:Include>
                                    <L7p:PolicyGuid stringValue="220d2644-8248-4548-9486-acadfee17294"/>
                                    </L7p:Include>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${retries_exceeded}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="true"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="TWF4aW11bSBMb2dpbiBBdHRlbXB0cyBFeGNlZWRlZA=="/>
                                    <L7p:EarlyResponse booleanValue="true"/>
                                    <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="403"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    <L7p:FalseAssertion/>
                                    </wsp:OneOrMore>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Authentication Failed - Handle Retry"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                            </wsp:OneOrMore>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Handle User Authentication"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.method}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Operator operator="NE"/>
                                    <L7p:RightValue stringValue="POST"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="Y2FsbA=="/>
                                <L7p:VariableToSet stringValue="state"/>
                            </L7p:SetVariable>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="client_id"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="client_id"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="scope"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="scope"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="response_type"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="response_type"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="redirect_uri"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="redirect_uri"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="display"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="display"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="prompt"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="prompt"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="state"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="state"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="gateway.time.HHssmmSSS"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="nonce"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="Y2xpZW50X2lkPSR7Y2xpZW50X2lkfSZyZXNwb25zZV90eXBlPSR7cmVzcG9uc2VfdHlwZX0mc2NvcGU9JHtzY29wZX0mcmVkaXJlY3RfdXJpPSR7cmVkaXJlY3RfdXJpfSZkaXNwbGF5PSR7ZGlzcGxheX0mcHJvbXB0PSR7cHJvbXB0fSZzdGF0ZT0ke3N0YXRlfSZub25jZT0ke25vbmNlfQ=="/>
                                <L7p:ContentType stringValue="application/x-www-form-urlencoded"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="authRequestParameters"/>
                            </L7p:SetVariable>
                            <L7p:HttpRoutingAssertion>
                                <L7p:FailOnErrorStatus booleanValue="false"/>
                                <L7p:ProtectedServiceUrl stringValue="https://explore.layer7.ca:8443/mag/auth/oauth/v2/authorize"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestMsgSrc stringValue="authRequestParameters"/>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:SamlAssertionVersion intValue="2"/>
                            </L7p:HttpRoutingAssertion>
                            <L7p:Regex>
                                <L7p:AutoTarget booleanValue="false"/>
                                <L7p:Regex stringValue="https://explore.layer7.ca:8443/mag/auth/oauth/v2/authorize"/>
                                <L7p:Replace booleanValue="true"/>
                                <L7p:Replacement stringValue="https://explore.layer7.ca:8443/alldata"/>
                                <L7p:Target target="RESPONSE"/>
                            </L7p:Regex>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Initiate authentication to request new access token"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                    </wsp:OneOrMore>
                </wsp:All>
            </wsp:Policy>
        </IncludedPolicyReference>
        <IncludedPolicyReference RefType="com.l7tech.console.policy.exporter.IncludedPolicyReference" guid="85c086c7-6d37-44d7-8244-7b812f85ee9b" included="true" name="Password Age Policy" soap="false" type="INCLUDE_FRAGMENT">
            <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
                <wsp:All wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="dHJ1ZQ=="/>
                        <L7p:VariableToSet stringValue="enforcePasswordAge"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="ZmFsc2U="/>
                        <L7p:VariableToSet stringValue="passwordExpired"/>
                    </L7p:SetVariable>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${enforcePasswordAge}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="true"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:JdbcQuery>
                                <L7p:ConnectionName stringValue="OAuth_MAG"/>
                                <L7p:NamingMap mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="expires"/>
                                    <L7p:value stringValue="expires"/>
                                    </L7p:entry>
                                </L7p:NamingMap>
                                <L7p:SqlQuery stringValue="select expires from user where id=${userid};"/>
                            </L7p:JdbcQuery>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtqZGJjUXVlcnkuZXhwaXJlc30="/>
                                <L7p:DataType variableDataType="dateTime"/>
                                <L7p:DateFormat stringValue="yyyy-MM-dd"/>
                                <L7p:DateOffsetExpression stringValue=""/>
                                <L7p:VariableToSet stringValue="passwordExpires"/>
                            </L7p:SetVariable>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue=""/>
                                <L7p:DataType variableDataType="dateTime"/>
                                <L7p:DateFormat stringValue="yyyy-MM-dd"/>
                                <L7p:DateOffsetExpression stringValue=""/>
                                <L7p:VariableToSet stringValue="currentDate"/>
                            </L7p:SetVariable>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValueReference="inline"><![CDATA[JDBC: ${passwordExpires}
GW: ${currentDate}]]></L7p:Detail>
                                <L7p:Level stringValue="WARNING"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${currentDate}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="dateTime"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Operator operator="LE"/>
                                    <L7p:RightValue stringValue="${passwordExpires}"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="dHJ1ZQ=="/>
                                <L7p:VariableToSet stringValue="passwordExpired"/>
                            </L7p:SetVariable>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="UGFzc3dvcmQgRXhwaXJlZA=="/>
                                <L7p:VariableToSet stringValue="this.app.name"/>
                            </L7p:SetVariable>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PHN0eWxlIHR5cGU9InRleHQvY3NzIj4NCmJvZHkuZHJhZ3tjdXJzb3I6bW92ZTt9dGguYWN0aXZlIGltZ3tkaXNwbGF5OmlubGluZTt9dHIuZXZlbix0ci5vZGR7YmFja2dyb3VuZC1jb2xvcjojZWVlO2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNjY2M7cGFkZGluZzowLjFlbSAwLjZlbTt9DQp0ci5kcmFne2JhY2tncm91bmQtY29sb3I6I2ZmZmZmMDt9dHIuZHJhZy1wcmV2aW91c3tiYWNrZ3JvdW5kLWNvbG9yOiNmZmQ7fQ0KdGQuYWN0aXZle2JhY2tncm91bmQtY29sb3I6I2RkZDt9dGQuY2hlY2tib3gsdGguY2hlY2tib3h7dGV4dC1hbGlnbjpjZW50ZXI7fQ0KdGJvZHl7Ym9yZGVyLXRvcDoxcHggc29saWQgI2NjYzt9dGJvZHkgdGh7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYzt9DQp0aGVhZCB0aHt0ZXh0LWFsaWduOmxlZnQ7DQogIHBhZGRpbmctcmlnaHQ6MWVtOw0KICBib3JkZXItYm90dG9tOjNweCBzb2xpZCAjY2NjO30NCi5icmVhZGNydW1ie3BhZGRpbmctYm90dG9tOi41ZW19ZGl2LmluZGVudGF0aW9ue3dpZHRoOjIwcHg7aGVpZ2h0OjEuN2VtO21hcmdpbjotMC40ZW0gMC4yZW0gLTAuNGVtIC0wLjRlbTsNCiAgcGFkZGluZzowLjQyZW0gMCAwLjQyZW0gMC42ZW07DQogIGZsb2F0OmxlZnQ7fQ0KdWwucHJpbWFyeXtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7cGFkZGluZzowIDAgMCAxZW07DQogIHdoaXRlLXNwYWNlOm5vd3JhcDtsaXN0LXN0eWxlOm5vbmU7bWFyZ2luOjVweDtoZWlnaHQ6YXV0bztsaW5lLWhlaWdodDpub3JtYWw7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2JiYjt9DQp1bC5wcmltYXJ5IGxpe2Rpc3BsYXk6aW5saW5lO311bC5wcmltYXJ5IGxpIGF7YmFja2dyb3VuZC1jb2xvcjojZGRkO2JvcmRlci1jb2xvcjojYmJiO2JvcmRlci13aWR0aDoxcHg7Ym9yZGVyLXN0eWxlOnNvbGlkIHNvbGlkIG5vbmUgc29saWQ7aGVpZ2h0OmF1dG87bWFyZ2luLXJpZ2h0OjAuNWVtOw0KICBwYWRkaW5nOjAgMWVtO3RleHQtZGVjb3JhdGlvbjpub25lO311bC5wcmltYXJ5IGxpLmFjdGl2ZSBhe2JhY2tncm91bmQtY29sb3I6I2ZmZjtib3JkZXI6MXB4IHNvbGlkICNiYmI7Ym9yZGVyLWJvdHRvbTojZmZmIDFweCBzb2xpZDt9DQp1bC5wcmltYXJ5IGxpIGE6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjojZWVlO2JvcmRlci1jb2xvcjojY2NjO2JvcmRlci1ib3R0b20tY29sb3I6I2VlZTt9dWwuc2Vjb25kYXJ5e2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNiYmI7cGFkZGluZzowLjVlbSAxZW07bWFyZ2luOjVweDt9DQoNCip7bWFyZ2luOjA7fQ0KaHRtbCxib2R5e2JhY2tncm91bmQ6I2ZmZjtmb250OjEycHgvMS4yZW0gaGVsdmV0aWNhLGFyaWFsLHNhbnMtc2VyaWY7Y29sb3I6IzRiNGI0YjtoZWlnaHQ6MTAwJTtsaW5lLWhlaWdodDoxLjNlbTt9DQpocntoZWlnaHQ6MXB4O2JhY2tncm91bmQtY29sb3I6I2RkZDsgbm8tcmVwZWF0IGNlbnRlciBib3R0b207cGFkZGluZzo4cHggYXV0bztib3JkZXI6MCBub25lO30NCmlucHV0e2NvbG9yOiM0YjRiNGI7fQ0KaDEsaDIsaDMsaDQsaDUsaDZ7cGFkZGluZzowO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LWZhbWlseTpoZWx2ZXRpY2EsYXJpYWwsc2Fucy1zZXJpZjt9DQpoMXtmb250LXNpemU6MjUwJTtjb2xvcjp3aGl0ZTt6LWluZGV4OjU7fQ0KaDJ7Zm9udC1zaXplOjE3NSU7fQ0KaDN7Zm9udC1zaXplOjE1MCU7fQ0KaDR7Zm9udC1zaXplOjEyMCU7fQ0KaDV7Zm9udC1zaXplOjExMCU7fQ0KaDZ7Zm9udC1zaXplOjEwNSU7fQ0KYTphY3RpdmUsYS5hY3RpdmV7Y29sb3I6IzRiNGI0Yjt0ZXh0LWRlY29yYXRpb246bm9uZTt9DQphOmxpbmssYTp2aXNpdGVke2NvbG9yOiM0YjRiNGI7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTtvdXRsaW5lOm5vbmU7fQ0KYTpob3Zlcntjb2xvcjojZGIzYjJjO3RleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7fQ0KcHttYXJnaW4tYm90dG9tOi41ZW07bGluZS1oZWlnaHQ6MS4zZW07bGlzdC1zdHlsZTpub25lO3RleHQtYWxpZ246bGVmdDtsaW5lLWhlaWdodDoxLjVlbTtjb2xvcjojNGI0YjRiO30NCmJsb2NrcXVvdGUgKnttYXJnaW46NXB4IDAgMCAxMHB4O311bHtsaW5lLWhlaWdodDoxLjVlbTsNCnBhZGRpbmc6LjJlbSAxZW0gMWVtIDFlbTt9b2x7bGluZS1oZWlnaHQ6MS41ZW07cGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kOm5vbmU7fWltZyxhIGltZ3tib3JkZXI6bm9uZTt9DQpuby1yZXBlYXQgbGVmdCAzNSU7bWFyZ2luLWxlZnQ6LjVlbTtwYWRkaW5nLWxlZnQ6MWVtO30NCiN3cmFwcGVye21pbi1oZWlnaHQ6MTAwJTtoZWlnaHQ6YXV0byAhaW1wb3J0YW50O2hlaWdodDoxMDAlO21hcmdpbjowIGF1dG8gLTVlbTt9I2NvbnRhaW5lcnttYXJnaW46LTIuNWVtIGF1dG8gMCAyLjVlbTt9DQouZmllbGQtY29udGVudCAudmlldy1kb20taWQtNSAudmlldy1jb250ZW50IC52aWV3cy1yb3d7DQogICAgbWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCiNzaWRlYmFyLWxlZnR7cG9zaXRpb246cmVsYXRpdmU7ZmxvYXQ6bGVmdDtjbGVhcjpsZWZ0O3BhZGRpbmc6MmVtIDAgNmVtIDA7ei1pbmRleDo1MDA7d2lkdGg6MTMuNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6IzY2Njt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbjo0LjNlbSBhdXRvIDFlbSAyLjVlbTt9DQouc3VibWl0dGVke2Rpc3BsYXk6bm9uZTt9LmNvbnRhaW5lcnt6LWluZGV4OjU7aGVpZ2h0OjEwMCU7cGFkZGluZy10b3A6LjJlbTt9DQoudGl0bGUtYm94IGgxe2NvbG9yOiNkYjNiMmM7bGluZS1oZWlnaHQ6MWVtO30NCg0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIHVse2JvcmRlcjowO2xpc3Qtc3R5bGU6bm9uZTtoZWlnaHQ6MzFweDttYXJnaW46MDtwYWRkaW5nOjA7d2lkdGg6MTAwJTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGl7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtib3JkZXI6MDtmbG9hdDpsZWZ0O21hcmdpbjowO3BhZGRpbmc6MDtsaXN0LXN0eWxlOm5vbmU7cG9zaXRpb246cmVsYXRpdmU7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIHVsIGxpIGF7ZGlzcGxheTpibG9jaztoZWlnaHQ6MzFweDt0ZXh0LWluZGVudDotNTAwMHB4O30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhe2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNjY2M7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpLm1lbnUtbWxpZC0yMzkzID4gYTpob3Zlcnt9DQoNCiNib3R0b21iYXJ7cG9zaXRpb246cmVsYXRpdmU7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxMy41ZW07Zm9udC1zaXplOjEzMCU7fQ0KI2JvdHRvbWJhciAuY29udGVudHttYXJnaW4tdG9wOi44ZW07fQ0KI2JvdHRvbWJhciBhe2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDNweCAzcHggM3B4O3RleHQtZGVjb3JhdGlvbjpub25lO30NCiNib3R0b21iYXIgYTpob3ZlciwNCiNib3R0b21iYXIgYS5hY3RpdmV7Y29sb3I6I2Q4M2IyYzt9DQojYm90dG9tYmFyIGJ7Zm9udC1zaXplOjEzMyU7fQ0KDQo8L3N0eWxlPg=="/>
                                <L7p:VariableToSet stringValue="website_style"/>
                            </L7p:SetVariable>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiINCiJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS1zdHJpY3QuZHRkIj4NCjxodG1sIGNsYXNzPSJqcyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgZGlyPSJsdHIiIGxhbmc9ImVuIj4NCjxoZWFkPg0KICAgIDxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Ij4NCiAgICA8dGl0bGU+JHt0aGlzLmFwcC5uYW1lfTwvdGl0bGU+DQo8L2hlYWQ+DQoke3dlYnNpdGVfc3R5bGV9DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPiR7Z2F0ZXdheS5icmFuZGluZy5zdHlsZX08L3N0eWxlPg0KPGJvZHkgY2xhc3M9InNpZGViYXItbGVmdCBjcm9uLWNoZWNrLXByb2Nlc3NlZCI+DQo8ZGl2IGlkPSJ3cmFwcGVyIj4NCjxkaXYgaWQ9Im1lbnVia2ciPjwvZGl2Pg0KPGRpdiBpZD0iY29udGFpbmVyIj4NCjxkaXYgaWQ9ImhlYWRlciI+DQogICAgPGRpdiBpZD0ibG9nby1mbG9hdGVyIj4NCgkJPGEgdGl0bGU9IiIgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofSI+PGltZyBpZD0ibG9nbyIgIGhlaWdodD0iNTMiIHdpZHRoPSIxNTkiIGFsdD0iTGF5ZXI3IiBzcmM9IiR7Z2F0ZXdheS5icmFuZGluZy5sb2dvLnVybH0iPjwvYT4NCgk8L2Rpdj4JDQo8L2Rpdj4NCjxkaXYgaWQ9ImNvbnRlbnQiPg0KCTxpZnJhbWUgc3R5bGU9ImRpc3BsYXk6bm9uZSIgc3JjPSIiIGlkPSJteWlmcmFtZSIgZnJhbWVib3JkZXI9IjAiIHNjcm9sbGluZz0iYXV0byI+DQoJPC9pZnJhbWU+DQoJCTxkaXYgaWQ9ImNvbnRlbnRfbGFuZGluZ19wYWdlIj4gICAgICAgICAgICAgIA0KCQk8ZGl2IGNsYXNzPSJ2aWV3IHZpZXctcHJvZHVjdHMzIHZpZXctaWQtcHJvZHVjdHMzIHZpZXctZGlzcGxheS1pZC1wYWdlXzEgdmlldy1kb20taWQtMSI+CQkNCgkJPGRpdiBjbGFzcz0iY29udGFpbmVyIj4NCgkJPGRpdiBjbGFzcz0idGl0bGUtYm94Ij4NCgkJPGgxPiR7dGhpcy5hcHAubmFtZX08L2gxPg0KCQk8YnI+DQoJCQ0KCQk8cD48L3A+DQoJCQkNCgkJPC9kaXY+DQoNCgkJIDxkaXYgY2xhc3M9InZpZXcgdmlldy1wcm9kdWN0czMgdmlldy1pZC1wcm9kdWN0czMgdmlldy1kaXNwbGF5LWlkLXBhZ2VfMSB2aWV3LWRvbS1pZC0xIj4JDQo8ZGl2IGNsYXNzPSJjb250YWluZXIiPg=="/>
                                <L7p:VariableToSet stringValue="website_top"/>
                            </L7p:SetVariable>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PC9kaXY+DQo8L2Rpdj48L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4="/>
                                <L7p:VariableToSet stringValue="website_bottom"/>
                            </L7p:SetVariable>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="userid"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="sessionID"/>
                                <L7p:TransformType transformType="BASE64_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:EncodeDecode>
                                <L7p:SourceVariableName stringValue="sessionID"/>
                                <L7p:TargetDataType variableDataType="string"/>
                                <L7p:TargetVariableName stringValue="sessionID"/>
                                <L7p:TransformType transformType="URL_ENCODE"/>
                            </L7p:EncodeDecode>
                            <L7p:HardcodedResponse>
                                <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="200"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:AssertionComment>
                                <L7p:Base64ResponseBody stringValue="JHt3ZWJzaXRlX3RvcH0KCQkgCjxkaXY+Cgo8cD5Zb3VyIHBhc3N3b3JkIGhhcyBleHBpcmVkLiBQbGVhc2UgZW50ZXIgeW91ciBuZXcgcGFzc3dvcmQgYmVsb3c6PC9wPgoKPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iIG1ldGhvZD0icG9zdCI+Cgk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzZXNzaW9uSUQiIHZhbHVlPSIke3Nlc3Npb25JRH0iLz4KIDx0YWJsZT4KIDx0cj4KICA8dGQ+TmV3IFBhc3N3b3JkOjwvdGQ+PHRkPjxpbnB1dCB0eXBlPSJwYXNzd29yZCIgbmFtZT0icGFzc3dvcmQiIHZhbHVlPSIiLz48L3RkPgogPC90cj4KIDx0cj4KICA8dGQ+Q29uZmlybSBQYXNzd29yZDo8L3RkPjx0ZD48aW5wdXQgdHlwZT0icGFzc3dvcmQiIG5hbWU9ImNvbmZpcm1QYXNzd29yZCIgdmFsdWU9IiIvPjwvdGQ+CiA8L3RyPgogPHRyPgogIDx0ZD48aW5wdXQgdHlwZT0ic3VibWl0IiBuYW1lPSJyZXNldFBhc3N3b3JkIiB2YWx1ZT0iU3VibWl0Ii8+PC90ZD4KIDwvdHI+CiA8L3RhYmxlPgo8L2Zvcm0+Cgo8L2Rpdj4KCiR7d2Vic2l0ZV9ib3R0b219"/>
                                <L7p:EarlyResponse booleanValue="true"/>
                                <L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/>
                            </L7p:HardcodedResponse>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <L7p:ExportVariables>
                        <L7p:ExportedVars stringArrayValue="included">
                            <L7p:item stringValue="passwordExpired"/>
                        </L7p:ExportedVars>
                    </L7p:ExportVariables>
                </wsp:All>
            </wsp:Policy>
        </IncludedPolicyReference>
        <JdbcConnectionReference RefType="com.l7tech.console.policy.exporter.JdbcConnectionReference">
            <ConnectionName>OAuth_MAG</ConnectionName>
            <DriverClass>com.mysql.jdbc.Driver</DriverClass>
            <JdbcUrl>jdbc:mysql://localhost:3306/otk_mag_db</JdbcUrl>
            <UserName>otk_mag_user</UserName>
            <AdditionalProperties/>
        </JdbcConnectionReference>
        <IncludedPolicyReference RefType="com.l7tech.console.policy.exporter.IncludedPolicyReference" guid="cdfe58f1-5bf6-4893-b6b6-0be6c736ac9b" included="true" name="Check Account Validity" soap="false" type="INCLUDE_FRAGMENT">
            <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
                <wsp:All wsp:Usage="Required">
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:JdbcQuery>
                                <L7p:ConnectionName stringValue="OAuth_MAG"/>
                                <L7p:NamingMap mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="status"/>
                                    <L7p:value stringValue="status"/>
                                    </L7p:entry>
                                </L7p:NamingMap>
                                <L7p:SqlQuery stringValue="select status from user where id=${userid};"/>
                            </L7p:JdbcQuery>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtqZGJjUXVlcnkuc3RhdHVzfQ=="/>
                                <L7p:VariableToSet stringValue="accountStatus"/>
                            </L7p:SetVariable>
                        </wsp:All>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="aW52YWxpZA=="/>
                            <L7p:VariableToSet stringValue="accountStatus"/>
                        </L7p:SetVariable>
                    </wsp:OneOrMore>
                    <L7p:ExportVariables>
                        <L7p:ExportedVars stringArrayValue="included">
                            <L7p:item stringValue="accountStatus"/>
                        </L7p:ExportedVars>
                    </L7p:ExportVariables>
                </wsp:All>
            </wsp:Policy>
        </IncludedPolicyReference>
        <IncludedPolicyReference RefType="com.l7tech.console.policy.exporter.IncludedPolicyReference" guid="8e1d00e2-f87e-4492-82d3-02364932085d" included="true" name="Manage Tokens" soap="false" type="INCLUDE_FRAGMENT">
            <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
                <wsp:All wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnN0YXRlfQ=="/>
                        <L7p:Enabled booleanValue="false"/>
                        <L7p:VariableToSet stringValue="state"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="ZmFsc2U="/>
                        <L7p:VariableToSet stringValue="issueToken"/>
                    </L7p:SetVariable>
                    <L7p:JdbcQuery>
                        <L7p:ConnectionName stringValue="OAuth_MAG"/>
                        <L7p:NamingMap mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="max_session"/>
                                <L7p:value stringValue="max_session"/>
                            </L7p:entry>
                        </L7p:NamingMap>
                        <L7p:SqlQuery stringValue="select max_session from user where id=${userid}"/>
                    </L7p:JdbcQuery>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="JHtqZGJjUXVlcnkubWF4X3Nlc3Npb259"/>
                        <L7p:DataType variableDataType="int"/>
                        <L7p:VariableToSet stringValue="maxSessions"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="MA=="/>
                        <L7p:DataType variableDataType="int"/>
                        <L7p:VariableToSet stringValue="numSessions"/>
                    </L7p:SetVariable>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:JdbcQuery>
                                <L7p:ConnectionName stringValue="OAuth_MAG"/>
                                <L7p:NamingMap mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="count(resource_owner)"/>
                                    <L7p:value stringValue="count"/>
                                    </L7p:entry>
                                </L7p:NamingMap>
                                <L7p:SqlQuery stringValue="select count(resource_owner) from oauth_token where resource_owner=${userid};"/>
                            </L7p:JdbcQuery>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtqZGJjUXVlcnkuY291bnR9"/>
                                <L7p:DataType variableDataType="int"/>
                                <L7p:VariableToSet stringValue="numSessions"/>
                            </L7p:SetVariable>
                        </wsp:All>
                        <L7p:TrueAssertion/>
                        <L7p:assertionComment>
                            <L7p:Properties mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="// Determine number of existing sessions"/>
                                </L7p:entry>
                            </L7p:Properties>
                        </L7p:assertionComment>
                    </wsp:OneOrMore>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValueReference="inline"><![CDATA[USER ID: ${userid}
NUM SESSIONS: ${numSessions}
MAX SESSIONS: ${maxSessions}]]></L7p:Detail>
                        <L7p:Level stringValue="WARNING"/>
                    </L7p:AuditDetailAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${numSessions}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="int"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Operator operator="GE"/>
                                    <L7p:RightValue stringValue="${maxSessions}"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="// DISPLAY LIST OF TOKENS"/>
                            </L7p:CommentAssertion>
                            <wsp:All wsp:Usage="Required">
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="token"/>
                                </L7p:SetVariable>
                                <L7p:JdbcQuery>
                                    <L7p:ConnectionName stringValue="OAuth_MAG"/>
                                    <L7p:GenerateXmlResult booleanValue="true"/>
                                    <L7p:NamingMap mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="token"/>
                                    <L7p:value stringValue="token"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="expiration"/>
                                    <L7p:value stringValue="expiration"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="client_name"/>
                                    <L7p:value stringValue="client_name"/>
                                    </L7p:entry>
                                    </L7p:NamingMap>
                                    <L7p:SqlQuery stringValue="select token, expiration, client_name from oauth_token where resource_owner=${userid};"/>
                                </L7p:JdbcQuery>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtqZGJjUXVlcnkueG1sUmVzdWx0fQ=="/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="jdbcResults"/>
                                </L7p:SetVariable>
                                <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="JDBCQUERY: ${jdbcQuery.xmlResult}"/>
                                    <L7p:Level stringValue="WARNING"/>
                                </L7p:AuditDetailAssertion>
                                <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue="jdbcResults"/>
                                    <L7p:XmlMsgSrc stringValue="jdbcResults"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/L7j:jdbcQueryResult/L7j:row"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="L7j"/>
                                    <L7p:value stringValue="http://ns.l7tech.com/2012/08/jdbc-query-result"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                </L7p:ResponseXpathAssertion>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHA+VXNlciBJRDogJHt1c2VyaWR9PC9wPg=="/>
                                    <L7p:VariableToSet stringValue="message"/>
                                </L7p:SetVariable>
                                <L7p:ForEachLoop L7p:Usage="Required" iterationLimit="10" loopVariable="jdbcResults.elements" variablePrefix="itr">
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="ITR: ${itr.current}"/>
                                    <L7p:Level stringValue="WARNING"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCiR7aXRyLmN1cnJlbnR9"/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="row"/>
                                    </L7p:SetVariable>
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue="expiration"/>
                                    <L7p:XmlMsgSrc stringValue="row"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/L7j:row/L7j:col[name='expiration']"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="L7j"/>
                                    <L7p:value stringValue="http://ns.l7tech.com/2012/08/jdbc-query-result"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_2_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue="client"/>
                                    <L7p:XmlMsgSrc stringValue="row"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/L7j:row/L7j:col[name='client_name']"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="L7j"/>
                                    <L7p:value stringValue="http://ns.l7tech.com/2012/08/jdbc-query-result"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_2_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue="token"/>
                                    <L7p:XmlMsgSrc stringValue="row"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/L7j:row/L7j:col[name='token']"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="L7j"/>
                                    <L7p:value stringValue="http://ns.l7tech.com/2012/08/jdbc-query-result"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_2_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHttZXNzYWdlfQ0KPGJyPg0KPHA+Q2xpZW50IE5hbWU6ICR7Y2xpZW50LnJlc3VsdH08L3A+DQo8cD5Ub2tlbjogJHt0b2tlbi5yZXN1bHR9PC9wPg0KPHA+RXhwaXJ5IFRpbWU6ICR7ZXhwaXJhdGlvbi5yZXN1bHR9PC9wPg0KPGZvcm0gYWN0aW9uPSIke3NlcnZpY2UudXJsfSIgbWV0aG9kPSJQT1NUIj4NCgk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIgdmFsdWU9ImRlbGV0ZSIvPg0KCTxpbnB1dCB0eXBlPSJoaWRkZW4iIE5hbWU9InVzZXJpZCIgdmFsdWU9IiR7dXNlcmlkfSIvPgkNCgk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iZGVsZXRlIi8+DQo8L2Zvcm0+"/>
                                    <L7p:VariableToSet stringValue="message"/>
                                    </L7p:SetVariable>
                                </L7p:ForEachLoop>
                                <L7p:HardcodedResponse>
                                    <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="200"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:AssertionComment>
                                    <L7p:Base64ResponseBody stringValue="JHt3ZWJzaXRlX3RvcH0KJHttZXNzYWdlfQoke3dlYnNpdGVfYm90dG9tfQ=="/>
                                    <L7p:EarlyResponse booleanValue="true"/>
                                    <L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/>
                                </L7p:HardcodedResponse>
                            </wsp:All>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="dHJ1ZQ=="/>
                                <L7p:VariableToSet stringValue="issueToken"/>
                            </L7p:SetVariable>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <wsp:All L7p:Enabled="false" wsp:Usage="Required">
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="VG9rZW4gTWFuYWdlcg=="/>
                            <L7p:VariableToSet stringValue="this.app.name"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="aHR0cHM6Ly8ke3JlcXVlc3QudXJsLmhvc3R9Ojg0NDMke3JlcXVlc3QudXJsLnBhdGh9"/>
                            <L7p:VariableToSet stringValue="this.app.url"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="PHN0eWxlIHR5cGU9InRleHQvY3NzIj4NCmJvZHkuZHJhZ3tjdXJzb3I6bW92ZTt9dGguYWN0aXZlIGltZ3tkaXNwbGF5OmlubGluZTt9dHIuZXZlbix0ci5vZGR7YmFja2dyb3VuZC1jb2xvcjojZWVlO2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNjY2M7cGFkZGluZzowLjFlbSAwLjZlbTt9DQp0ci5kcmFne2JhY2tncm91bmQtY29sb3I6I2ZmZmZmMDt9dHIuZHJhZy1wcmV2aW91c3tiYWNrZ3JvdW5kLWNvbG9yOiNmZmQ7fQ0KdGQuYWN0aXZle2JhY2tncm91bmQtY29sb3I6I2RkZDt9dGQuY2hlY2tib3gsdGguY2hlY2tib3h7dGV4dC1hbGlnbjpjZW50ZXI7fQ0KdGJvZHl7Ym9yZGVyLXRvcDoxcHggc29saWQgI2NjYzt9dGJvZHkgdGh7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYzt9DQp0aGVhZCB0aHt0ZXh0LWFsaWduOmxlZnQ7DQogICAgcGFkZGluZy1yaWdodDoxZW07DQogICAgYm9yZGVyLWJvdHRvbTozcHggc29saWQgI2NjYzt9DQouYnJlYWRjcnVtYntwYWRkaW5nLWJvdHRvbTouNWVtfWRpdi5pbmRlbnRhdGlvbnt3aWR0aDoyMHB4O2hlaWdodDoxLjdlbTttYXJnaW46LTAuNGVtIDAuMmVtIC0wLjRlbSAtMC40ZW07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOjAuNDJlbSAwIDAuNDJlbSAwLjZlbTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0OmxlZnQ7fQ0KdWwucHJpbWFyeXtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7cGFkZGluZzowIDAgMCAxZW07DQogICAgd2hpdGUtc3BhY2U6bm93cmFwO2xpc3Qtc3R5bGU6bm9uZTttYXJnaW46NXB4O2hlaWdodDphdXRvO2xpbmUtaGVpZ2h0Om5vcm1hbDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjYmJiO30NCnVsLnByaW1hcnkgbGl7ZGlzcGxheTppbmxpbmU7fXVsLnByaW1hcnkgbGkgYXtiYWNrZ3JvdW5kLWNvbG9yOiNkZGQ7Ym9yZGVyLWNvbG9yOiNiYmI7Ym9yZGVyLXdpZHRoOjFweDtib3JkZXItc3R5bGU6c29saWQgc29saWQgbm9uZSBzb2xpZDtoZWlnaHQ6YXV0bzttYXJnaW4tcmlnaHQ6MC41ZW07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzowIDFlbTt0ZXh0LWRlY29yYXRpb246bm9uZTt9dWwucHJpbWFyeSBsaS5hY3RpdmUgYXtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7Ym9yZGVyOjFweCBzb2xpZCAjYmJiO2JvcmRlci1ib3R0b206I2ZmZiAxcHggc29saWQ7fQ0KdWwucHJpbWFyeSBsaSBhOmhvdmVye2JhY2tncm91bmQtY29sb3I6I2VlZTtib3JkZXItY29sb3I6I2NjYztib3JkZXItYm90dG9tLWNvbG9yOiNlZWU7fXVsLnNlY29uZGFyeXtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjYmJiO3BhZGRpbmc6MC41ZW0gMWVtO21hcmdpbjo1cHg7fQ0KDQoqe21hcmdpbjowO30NCmh0bWwsYm9keXtiYWNrZ3JvdW5kOiNmZmY7Zm9udDoxMnB4LzEuMmVtIGhlbHZldGljYSxhcmlhbCxzYW5zLXNlcmlmO2NvbG9yOiM0YjRiNGI7aGVpZ2h0OjEwMCU7bGluZS1oZWlnaHQ6MS4zZW07fQ0KaHJ7aGVpZ2h0OjFweDtiYWNrZ3JvdW5kLWNvbG9yOiNkZGQ7IG5vLXJlcGVhdCBjZW50ZXIgYm90dG9tO3BhZGRpbmc6OHB4IGF1dG87Ym9yZGVyOjAgbm9uZTt9DQppbnB1dHtjb2xvcjojNGI0YjRiO30NCmgxLGgyLGgzLGg0LGg1LGg2e3BhZGRpbmc6MDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1mYW1pbHk6aGVsdmV0aWNhLGFyaWFsLHNhbnMtc2VyaWY7fQ0KaDF7Zm9udC1zaXplOjI1MCU7Y29sb3I6d2hpdGU7ei1pbmRleDo1O30NCmgye2ZvbnQtc2l6ZToxNzUlO30NCmgze2ZvbnQtc2l6ZToxNTAlO30NCmg0e2ZvbnQtc2l6ZToxMjAlO30NCmg1e2ZvbnQtc2l6ZToxMTAlO30NCmg2e2ZvbnQtc2l6ZToxMDUlO30NCmE6YWN0aXZlLGEuYWN0aXZle2NvbG9yOiM0YjRiNGI7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fQ0KYTpsaW5rLGE6dmlzaXRlZHtjb2xvcjojNGI0YjRiO3RleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7b3V0bGluZTpub25lO30NCmE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lO30NCnB7bWFyZ2luLWJvdHRvbTouNWVtO2xpbmUtaGVpZ2h0OjEuM2VtO2xpc3Qtc3R5bGU6bm9uZTt0ZXh0LWFsaWduOmxlZnQ7bGluZS1oZWlnaHQ6MS41ZW07Y29sb3I6IzRiNGI0Yjt9DQpibG9ja3F1b3RlICp7bWFyZ2luOjVweCAwIDAgMTBweDt9dWx7bGluZS1oZWlnaHQ6MS41ZW07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6LjJlbSAxZW0gMWVtIDFlbTt9b2x7bGluZS1oZWlnaHQ6MS41ZW07cGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kOm5vbmU7fWltZyxhIGltZ3tib3JkZXI6bm9uZTt9DQpuby1yZXBlYXQgbGVmdCAzNSU7bWFyZ2luLWxlZnQ6LjVlbTtwYWRkaW5nLWxlZnQ6MWVtO30NCiN3cmFwcGVye21pbi1oZWlnaHQ6MTAwJTtoZWlnaHQ6YXV0byAhaW1wb3J0YW50O2hlaWdodDoxMDAlO21hcmdpbjowIGF1dG8gLTVlbTt9I2NvbnRhaW5lcnttYXJnaW46LTIuNWVtIGF1dG8gMCAyLjVlbTt9DQouZmllbGQtY29udGVudCAudmlldy1kb20taWQtNSAudmlldy1jb250ZW50IC52aWV3cy1yb3d7DQogICAgbWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCiNzaWRlYmFyLWxlZnR7cG9zaXRpb246cmVsYXRpdmU7ZmxvYXQ6bGVmdDtjbGVhcjpsZWZ0O3BhZGRpbmc6MmVtIDAgNmVtIDA7ei1pbmRleDo1MDA7d2lkdGg6MTMuNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6IzY2Njt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbjo0LjNlbSBhdXRvIDFlbSAyLjVlbTt9DQouc3VibWl0dGVke2Rpc3BsYXk6bm9uZTt9LmNvbnRhaW5lcnt6LWluZGV4OjU7aGVpZ2h0OjEwMCU7cGFkZGluZy10b3A6LjJlbTt9DQoudGl0bGUtYm94IGgxe2NvbG9yOiNkYjNiMmM7bGluZS1oZWlnaHQ6MWVtO30NCg0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIHVse2JvcmRlcjowO2xpc3Qtc3R5bGU6bm9uZTtoZWlnaHQ6MzFweDttYXJnaW46MDtwYWRkaW5nOjA7d2lkdGg6MTAwJTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGl7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtib3JkZXI6MDtmbG9hdDpsZWZ0O21hcmdpbjowO3BhZGRpbmc6MDtsaXN0LXN0eWxlOm5vbmU7cG9zaXRpb246cmVsYXRpdmU7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIHVsIGxpIGF7ZGlzcGxheTpibG9jaztoZWlnaHQ6MzFweDt0ZXh0LWluZGVudDotNTAwMHB4O30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhe2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNjY2M7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpLm1lbnUtbWxpZC0yMzkzID4gYTpob3Zlcnt9DQoNCiNib3R0b21iYXJ7cG9zaXRpb246cmVsYXRpdmU7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxMy41ZW07Zm9udC1zaXplOjEzMCU7fQ0KI2JvdHRvbWJhciAuY29udGVudHttYXJnaW4tdG9wOi44ZW07fQ0KI2JvdHRvbWJhciBhe2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDNweCAzcHggM3B4O3RleHQtZGVjb3JhdGlvbjpub25lO30NCiNib3R0b21iYXIgYTpob3ZlciwNCiNib3R0b21iYXIgYS5hY3RpdmV7Y29sb3I6I2Q4M2IyYzt9DQojYm90dG9tYmFyIGJ7Zm9udC1zaXplOjEzMyU7fQ0KDQo8L3N0eWxlPg=="/>
                            <L7p:VariableToSet stringValue="website_style"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="PGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgbGFuZz0iZW4iIGRpcj0ibHRyIj4NCjxoZWFkPg0KPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiIC8+DQo8dGl0bGU+JHt0aGlzLmFwcC5uYW1lfTwvdGl0bGU+DQoke3dlYnNpdGVfc3R5bGV9DQo8L2hlYWQ+DQoNCjxib2R5Pg0KICAgICA8ZGl2IGlkPSJtZW51YmtnIj48L2Rpdj4NCiAgICAgPGRpdiBpZD0iY29udGFpbmVyIj4NCgkgIDxkaXYgaWQ9ImhlYWRlciI+DQoJCQk8ZGl2IGlkPSJsb2dvLWZsb2F0ZXIiPjxhIHRpdGxlPSIiIGhyZWY9IiR7cmVxdWVzdC51cmwucGF0aH0iPjxpbWcgaWQ9ImxvZ28iIGFsdD0iTGF5ZXI3IiBzcmM9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBSjhBQUFBMUNBTUFBQUJvUXNsYUFBQUFHWFJGV0hSVGIyWjBkMkZ5WlFCQlpHOWlaU0JKYldGblpWSmxZV1I1Y2NsbFBBQUFBTUJRVEZSRkZCQU1qSTZPN3FPbGEyOXc1dWZuOU1qSjVtRmd5TWpJVDFKUzRUd3QxZGZZdExlNCtmbjU4L1QwcDZpblhXTm0rZVRsL3Z6Nyt2MytxN3E4K3Z6NSt1L3cvZm43d01QRTZvZUlnSVNHMGRMUytmdjgvZnovOXZqNjcvRHpvNkdmVlZ4ZjkvajNxNjZ3K2ZmMHVidTlucUtrUkVFOTI5emR5ODNPdjhDKzlmWDE3ZTd1NnV2cjR1UGs1RXhJZDN0N3JxMnJYbHRYaG9TQjk5amFsWmlaMytEZ0x5d29aV1Joc3JPeThmSHhuWjZkK1BqNysvejcvUHo4L2YzOS8vLy9BU0REWXdBQURGcEpSRUZVZU5yVVdXdDdxam9XTnFMRmVnRmhLQlozMm9xMUZhdVUzWXB1VzVPcy8vK3ZacTBrSUxaMjVubm13NXh6Y3M2MkdJSjU4Njc3b2dWLzc5SDZSK0JUVWtrcGhWRDZHd2VoRk1oQXFiOEpQZ1VLRVVrSnNKNGM1b3VjQUVzaGFRSXYxVitQVHhsMGQ1T0VzWVFsZ3hmZ2dRajFyUHByRWJZcThRS0lhWmw4WnN0bDMyUE01VURRQ0o4ZWZ6aytnSjJYTU5kTUxsbmlvWkFSbXpRVS9uVUFyWHdoekpKa0VBT1hJbENTaTBYQ3NrZlNRUVdhUXZqL0FOUzd5Ty8yeS9sNi9yblJWcUlDeEFOOFU1WWRRNjJtOTM5QytEUHY2b2RyWXd2ZjhVaytHaUVvZERDeGlCWENSRlM3VHQ1ZmRzalhrSkExeUsrN2ZOOWRXVXlxd21lVnQ5cFZOVWZsMmhvVHlqSlIzOWI0QW40emZnUWVjYUVDcnJnSU9NTEtGeXhKeXNrYTBaUHpVZWRuL1dJMHArMDFMRERiR050WHArWHF6TnFVT1UwTlQ5b0orUldmaXR1dnQrTUl0UzhLd29DZ3lNMnFLRHgzeFp5eW4yb3oxdDVRblVuTi9EWjgyMTV2Skp2RVdBZG1yNFNzVjFXYzZjZmwyWU5OK1c2dnJxK3YyemNoaUFBQ0JEUEttRFBRZHpiTVdXeENhOG9uUUtBM3JLZk0vcWZQMDExek5IdERtbW5aUE1XRklXbWM0M3RGZk5kWDNVY0ZrZUF5TC8ybkQySk5CZ0J1a1V6dnlKSTFoNnJ5NXJLR0lwdUFEQXo3V1grVE5iN0dBVVFEZFBWRDFWSlFKbmhaK1JwODE5ZTNOMXh5OVZFazVQMDQyb3RRQWw2ZW5Ea29EUkFzQ0VPTGFzckpUZ3VoVDYram83VFgxYXpRZjRUR1pTY2E0UFE1Nmtkd3YyLzg0WGdkY3g1MGxnb0VqNVFJMEY0b1oxZytRWXhpRnlBcUhhSGZqWEEvWEIxb1dJVDlseGlLNFJDUFJFaUcrSW4vNlVOaXFNVHZkRmZQUjFKRzBURTBpeUs5RG45SHhYRVU0d2hpRWVBZnhiL3FueDVYWVloN3hmZ0xDcDhJU0pzRGN4NkJGNHB6ZlZiQTAyMG1yanRGbnlSQlJxQXpuazdtdW02VzR4bGU4TUpkSXoxQ2JhYXUyeDlCeDYxR0gyZGg2bWI2eTNTdFFoNHJDQUtRM2ViWTNzQUYrZUlZODVBOERSNUlCc2hJRUFqdFc1UndsMFpRV2tZSThkQnF0WjVCSzZiVTBnY0haL2F0Ti9RUG5SNWVGUytrUkFWT0ZpL3dvTy9Sdno4WWwrRFpmbTN0ZTJpSElXN0IxWFZ6dkhiRGkveWhGVitoR29ZU014akVGUk5heUV0bkVIbysyeWxKSEpJYUNmaHQ4QkcxNU5BRmJONW93MWF2QXlxbG02MGxLdThISVQwQWZMYXE4ZllJQnA4ZGU0K2lLajcvQlI5YzBqL0UxNlc3YlZBOE5Cb05MNTdqK3c2ODdKNThiNFNTRElXMlk4MmZFbGFuVVUxWFp0UG5GYXBwaDY0L1h3QThaTW41QU1OZitjN2UzNzFVQ0kzdmM1TVBlblFnQ0RFcXhQd0x2cWIramEvTzhhRWVia21tS0FudUZyNVArQVI2eGFTWVlMUWg4VXJMWHloalBBVUZRWGhIYm1pL2R6VDlpTzd1MFF2UWhJYyt2U1Fnang4NFJtU2FoTzgzYmtEd245Y1E0MXc0cmdhQnVZMGI4ZzM1N1ZkOHVPSVJqWmJuelBFTnZnQ05lbk53eWcwUXE1YS9vSElKU2oyaWVKMFM5M3ZEZldGRENBNThpbi9lZGhCcS9ucUJEbmJTNnQ4RDh1eml4Zk9HNC9OaEhTdmJSTThZZ21aK2RWTEFHdC8xN1poRHYvQm5CaDg2QVB6NWRNa3lyclJiTlB3SlRTWjZETWh3SzVZalg4OW93VUhzNmR1TzRTa3cvSm45dWNYbkliNEo0ZnNBTkdFVm9aREpteEc4MTIzWTlDK2hDcnV2My9CZHQySDBhZEFSZnhLZlJwKzVTVnlJNWNsK2NUZEI1d2UyYisxL0U2RDlncXg2UStiNVlPaERRTVRmYzdiQ2dXNkhXL21DaHYyR2d0R3VtWWRoREFUa3RSdEV2SkVmU0I2cTdlMDNmRmZqekRuaEU5YXBUM2RBL3JqaUw0ekk1d2lBUDdoVHJqY3NLT09SekxxUTMrU0F0UDN1bjJsTUkybncvZm44TEVqOU1sd2VDUlBaakNXMFkya1RKaXRmakFMaFkvZnFDNzdyN3I4cWVBWmZoUEFtWlpMQmlUL2lUcEIxa01XK3JhYUVxa2NpVjVwQVE1OHcvSmt4aVdYbFgzREYzc2twQmRSbnhHZ2YzaHJORDdocytCZFNkMVN1bXpaeTJ6M0QxNnZ3L1FFOEkwRC8wNW4xUEF4enRmL2oyanRMN1VpSUlHSmtpUklONFgxUEFCNkdRRTVLOC9kZUZNWDdMbERHdnp5LzBXY1BuYU5HUndsRFpSdFlhRFRsaXlyTE1kNUN1RzIzYjdZWDhTVW9TY2pueFd6bTk3d1hpbThOL1ZOR3ZMWEhKYzhSQ20zQ2lKWElNZllMNlV1YXhqd3kvTEhjMWZMdEU4SEc1NCsxOGluS1E0TW1Qc3p0MGRQRitpcSt1b1RQeGZqcU1tM01QZThPL1YzRlgyZ3l1Zzh5eElJeFJrRUV5WmFoZ2orNE94dVJQekg4V2ZzbGFWbjcwQ0huWGF1clRxaU04bW55ZU5Td0QxUUJpdndpeHJTRmQ3L2pteVZwQUs0MUZvMVBXUDVVcUQwZ0xQYTBFWTRWVGFlNmhIRkl2S25CWi9qRENnS0xReW1zL3dQcmRpaENraEJvNTZzYkRDZGtFR2Y4WWRXR2tpSkY0Z0cwWDgveHpmd3loN2hUMlhMUE8wSnR2NVlTblFaNHBBTjlDcmdaWmVFVlB2TGhUZjhIMW43Si8ra2Z5Y0g0ZUUxZmx4Snlya0IrNlY5aDJzU3grRUJYT0I1M2J4djRabjR5V09hangza2w2cGxIbkdqKzloNk5oMXltejlwUlVOcUZTUGNNaUE1eXpwKzAxdXJmczE3dGRXejhmYkx4QS8ybER1TndvNDBqa3MybVN1dFU2bURtVERuVnpkVnJlOXUrc3ZobXZ2UFVYejRWZzRpZDhOMFJFTzlrRUFmbElsWEZtcXBsVVlsTTF2Z0lhM2xhdlJpcW1yLzhqemtOS1VuUU5kcW4vU0NjMVIrbXBxQ0dVQkRyL0tXN3ZYM0ZzMHg4aDJYNXdPL05IRlhqUS9zZHBjVGZuZ2I1a0JXVWVQRUFPazJZNFB4elNpY29hSkt1VU9HOGxsbU0vMCtHRXRPR3ZjYVhNcHp5WDB5bmdxVFdCYW1hTlhxcldWaFRiaGRWK2N2MnRzdEhrMFdlSmFTRURYeXp3M3JhUVZmNHpxclJoOS80aVY2UFdPczh2TE95UXh3Y0dIdlBocFR1WTNSTzZ0VTd4UEtBdDZhVVJ5d1pya1lGSklzam1XMjF4Ni9MdDdQK3FSSlluTWVOL0FYTDlBN3J6VXo4cVBETm5Lemo1dWRkRXZNbFVqclB0RTdFRm1BcU1nQWJRMWg2OERqcXRGcWJ4K3NXemh0bURYd3FDTWlFdTZmd2l5UVZ2U3ErV1h5ejJRQjJCK0xLVm1LbUVNTUxyblJDcTRlZVYxVVJaNUljazRjTlZaWFJtcHZDcmtUK1hnMitRRjdHaDNlVWlrVWpmd2xHWmVXZ1QvSjl1dGRucndEVXY2K0xPQU5HYW5kV0xSQ25zckcrUEFOSmc0SmV0OTN1M29SVkwrWGNQa0I3SFJYdzZJZjhSUnA4UmNZaEV1ZW5sNnF1Y3hWdFZKZFJwcWt0cTZVNnNiWHpOcUxWNEFPamNxaTFYUDNVdjBmcFloRjZPVDl3T09GekRpbUZWams4VXAwYnBWVEE0aVozUjVKb2RBeCtIZEZEaVNpU1I4UXBvelQ5RlFSQk5NUlNOK0RoOFU1RUZBV0d1QnpMNldIOEs2YTFRNFRMMDVUdXlhb3A4Z00rdkJGRVArQ0RKOTh2TjZIdUUrMFdoOE9xQTV2NVlYR1B6MHhZT1QxQ3VzcWdQMGxoMkIva284TWFmVUhHbUp0aWRiL0tLWVBlZUd5T3RRRWZMZEM4TWR4UEpxZ295L25CZllHMFh6SVhxdGJEai96cE5DWWUvNUMvakJiNWtKT1NTUmhOSExZWlFkOTNkNm1NWFNmM2loeEd5Uk40Q1c0Mm1EM2Qrem1Jek85UC9DbkFvTURBQXV0UHRpa3hjejNpMnJKY0F6QnFvaHljYVQ2RURmdTk5RGVxcW1SK3hFZmxMYitZdnpnVFVFT3RLaFRMWVZlVXVHWGZ6M0xFVnlhakhUTHpVYkJPaWVsS091Z2xmY1RINThuSHhobWtpTTlGQjlRdjVtcmhkT0JZeklmckhhWWJMRUVuT2krbUcweGozcFBwdlFoTUUrcTg3ZG42MGxzTndrdjVpNThjZFo5QTZFUlhhbndLK3JPazNLaVlKUitrMUtPa0dDUU0rVHY0SG5OeUdUSTJzdmd5aUFnZlRCRDIwVDkwUHIwUE1QZ0dmbkxBeEc3Si9PUWxNRG0rK3ZIOUZuVmIwSXVGM2V1ditRdTdWOWFibVVUTjhEZDE4aU9YdnhnNzVoZ0M3b3N5ZlNMNXpvdCt6OG01bWlmSGtiTVlJajRVTXZRUnlNS1g2cTd3K0lwMW9PSnZnM1hheDJTOTlKZWFBVkEvNngrbVZoSkJCdkcybWIvNHN3STFtU28vK3hZTVE4VFNZYmgwMm1OUFV4Q1RHZkxXZ1h1bmhLZGlCRVBQT1JiK0xwRDkyWno1ZmRReFB5a25jRjg2aStRVGt3WFBXYkFDb1NXb3N6Q2ZsZDRPT3NubndWL2JWMWcvNngrbERRRndyS1p2dWxYKzR2ZFFIaEZndW9qaEpiRDlRenp3bEZSK3NNSkFGOTI1MlNUSFVPLzJWVDhid25BNWdlWGlROG8wYzFmTFJ3VzcxV3FCOFlZNldHanRZajNKcHU0SUlLT1AzV0RpYnZDUmxkc1g1bzNRZjNoL2FYcWpPc2lIWTZ4RFg4ZVQzcXhjM2dISVpvZVRhRXlIMUhCTDB4U05Cc1JJdDZpRmFlaEpnU0VzcFRjVktrMHB0QTV4V1VxQ0d3MTEyaVZHMUFkVXFWNkx0eWgxZVVsQnlVdHZxbG9YWGhGd1VzUmcyOTdHNnltWjE2bUJyT29Hc21uTzZCNk5zdjF6cUJ2UTByUXNkVU5jTDlPbXBVeEh4eDdVTmx1MTFsRDZvTXlDLy9iK1YzY2ZqUjFEYUwyMlBPOWlOeHZldHNkck83SzZxeXgwRjFpYUJyTVEwcmFWcS82MWZsYlU0YnR1c1l2TGIva3V2Sjl1Tk9PcENSSkVsYzlVOWZzTWVYcDVhTFNtbG43VmY2OWIzK1kxbnUxYWF5YTFtNE5xN2FsbEQ1Y1EvalBlbi85OXg3OEZHQUNEOWdaSGl6NmVGZ0FBQUFCSlJVNUVya0pnZ2c9PSI+PC9hPjwvZGl2Pg0KDQogIAkJPC9kaXY+DQo8IS0tY2xvc2UgaGVhZGVyLS0+DQoNCjxkaXYgaWQ9ImNvbnRlbnQiPg0KDQoJPGlmcmFtZSBzdHlsZT0iZGlzcGxheTpub25lIiBzcmM9IiIgaWQ9Im15aWZyYW1lIiBmcmFtZWJvcmRlcj0iMCIgc2Nyb2xsaW5nPSJhdXRvIj4NCgk8L2lmcmFtZT4NCgkJPGRpdiBpZD0iY29udGVudF9sYW5kaW5nX3BhZ2UiPiAgICAgICAgICAgICAgDQoJCTxkaXYgY2xhc3M9InZpZXcgdmlldy1wcm9kdWN0czMgdmlldy1pZC1wcm9kdWN0czMgdmlldy1kaXNwbGF5LWlkLXBhZ2VfMSB2aWV3LWRvbS1pZC0xIj4JCQ0KCQk8ZGl2IGNsYXNzPSJjb250YWluZXIiPg0KCQk8ZGl2IGNsYXNzPSJ0aXRsZS1ib3giPg0KCQk8aDE+JHt0aGlzLmFwcC5uYW1lfTwvaDE+DQoJCTxicj4NCgkJDQoJCTxwPjwvcD4NCgkJCQ0KCQk8L2Rpdj4NCg0KCQkgPGRpdiBjbGFzcz0idmlldyB2aWV3LXByb2R1Y3RzMyB2aWV3LWlkLXByb2R1Y3RzMyB2aWV3LWRpc3BsYXktaWQtcGFnZV8xIHZpZXctZG9tLWlkLTEiPgkJDQo8ZGl2IGNsYXNzPSJjb250YWluZXIiPg0KPGRpdj4NCjx0YWJsZT4NCjx0cj4NCjx0ZD4NClVzZXIgSUQ6IDxmb3JtIGFjdGlvbj0iJHt0aGlzLmFwcC51cmx9IiBtZXRob2Q9R0VUPg0KCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InN0YXRlIiB2YWx1ZT0ic2VhcmNoIi8+DQoJPGlucHV0IHR5cGU9InRleHQiIE5hbWU9InVzZXJpZCIvPgkNCgk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iU2VhcmNoIi8+DQo8L2Zvcm0+DQo8L3RkPg0KPC90cj4NCjwvdGFibGU+DQo8L2Rpdj4NCjxocj4="/>
                            <L7p:VariableToSet stringValue="website_top"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHt3ZWJzaXRlX3RvcH0NCjxkaXY+DQpJIGFtIDxiPiR7dGhpcy5hcHAubmFtZX08L2I+IHRvIG1hbmFnZSBjbGllbnQgYXBwbGljYXRpb25zLiBZb3UgY2FuIG1hbmFnZSBjbGllbnQgYXBwcyBhbmQgZ3JhbnRlZCByZXNvdXJjZSBvd25lci9jbGllbnQgY29tYmluYXRpb25zDQo8dGFibGU+DQo8dHI+DQo8dGQ+DQo8Zm9ybSBhY3Rpb249IiR7dGhpcy5hcHAudXJsfSIgbWV0aG9kPUdFVD4NCgk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIgdmFsdWU9Im1hbmFnZUNsaWVudHMiLz4NCgk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iTWFuYWdlIENsaWVudHMiLz4NCjwvZm9ybT4NCjwvdGQ+DQo8dGQ+DQo8Zm9ybSBhY3Rpb249IiR7dGhpcy5hcHAudXJsfSIgbWV0aG9kPUdFVD4NCgk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIgdmFsdWU9Im1hbmFnZU93bmVyc0NsaWVudHMiLz4NCgk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iTWFuYWdlIFVzZXJzL0NsaWVudHMiLz4NCjwvZm9ybT4NCjwvdGQ+DQo8L3RyPg0KPC90YWJsZT4NCjwvZGl2Pg0KPGhyPg=="/>
                            <L7p:VariableToSet stringValue="htmlHeader"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="PGhyPg0KPGRpdj4NCjxwIGNsYXNzPSJmb290ZXIiPg0KTGF5ZXI3IFRlY2hub2xvZ2llcyBJbmMuLCAke2dhdGV3YXkudGltZS5kZC9NTS95eXl5fSAoRGF5LyBNb250aC8gWWVhcikNCjwvcD4NCjwvZGl2Pg0KPC9ib2R5Pg0KPC9odG1sPg=="/>
                            <L7p:VariableToSet stringValue="htmlFooter"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="PGJyIC8+DQo8aHI+DQo8L2JvZHk+DQo8L2h0bWw+"/>
                            <L7p:VariableToSet stringValue="website_bottom"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <wsp:OneOrMore L7p:Enabled="false" wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:Expression1 stringValue="${state}"/>
                                <L7p:Expression2 stringValue=""/>
                                <L7p:ExpressionIsVariable booleanValue="false"/>
                                <L7p:Operator operator="EMPTY"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="200"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:AssertionComment>
                                <L7p:Base64ResponseBody stringValue="JHt3ZWJzaXRlX3RvcH0KPHA+VGhpcyBtYW5hZ2VtZW50IGFwcGxpY2F0aW9uIGlzIGEgc2ltcGxlIHRvb2wgdG8gbWFuYWdlIGNsaWVudCBhcHBsaWNhdGlvbnMgYW5kIGdyYW50ZWQgcmVzb3VyY2Ugb3duZXIvY2xpZW50IGNvbWJpbmF0aW9uczwvcD4KJHt3ZWJzaXRlX2JvdHRvbX0="/>
                                <L7p:EarlyResponse booleanValue="true"/>
                                <L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/>
                            </L7p:HardcodedResponse>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:Expression1 stringValue="${state}"/>
                                <L7p:Expression2 stringValue="search"/>
                                <L7p:ExpressionIsVariable booleanValue="false"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="search"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue=""/>
                                <L7p:VariableToSet stringValue="token"/>
                            </L7p:SetVariable>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:JdbcQuery>
                                    <L7p:ConnectionName stringValue="OAuth_MAG"/>
                                    <L7p:MaxRecords intValue="1"/>
                                    <L7p:NamingMap mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="expire"/>
                                    <L7p:value stringValue="expire"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="token"/>
                                    <L7p:value stringValue="token"/>
                                    </L7p:entry>
                                    </L7p:NamingMap>
                                    <L7p:SqlQuery stringValue="select token, expire from tokenstore where userid=${request.http.parameter.userid};"/>
                                    </L7p:JdbcQuery>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHA+VXNlciBJRDogJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnVzZXJpZH08L3A+DQo8cD5Ub2tlbjogJHtqZGJjUXVlcnkudG9rZW59PC9wPg0KPHA+RXhwaXJ5IFRpbWU6ICR7amRiY1F1ZXJ5LmV4cGlyZX08L3A+DQo8Zm9ybSBhY3Rpb249IiR7dGhpcy5hcHAudXJsfSIgbWV0aG9kPUdFVD4NCgk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIgdmFsdWU9ImRlbGV0ZSIvPg0KCTxpbnB1dCB0eXBlPSJoaWRkZW4iIE5hbWU9InVzZXJpZCIgdmFsdWU9IiR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci51c2VyaWR9Ii8+CQ0KCTxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJkZWxldGUiLz4NCjwvZm9ybT4="/>
                                    <L7p:VariableToSet stringValue="message"/>
                                    </L7p:SetVariable>
                                </wsp:All>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHA+VXNlciBJRDogJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnVzZXJpZH08L3A+DQo8cD5ObyBUb2tlbiBGb3VuZDwvcD4="/>
                                    <L7p:VariableToSet stringValue="message"/>
                                </L7p:SetVariable>
                            </wsp:OneOrMore>
                            <L7p:HardcodedResponse>
                                <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="200"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:AssertionComment>
                                <L7p:Base64ResponseBody stringValue="JHt3ZWJzaXRlX3RvcH0KJHttZXNzYWdlfQoke3dlYnNpdGVfYm90dG9tfQ=="/>
                                <L7p:EarlyResponse booleanValue="true"/>
                                <L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/>
                            </L7p:HardcodedResponse>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:Expression1 stringValue="${state}"/>
                                <L7p:Expression2 stringValue="delete"/>
                                <L7p:ExpressionIsVariable booleanValue="false"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="delete"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:JdbcQuery>
                                    <L7p:ConnectionName stringValue="OAuth_MAG"/>
                                    <L7p:MaxRecords intValue="1"/>
                                    <L7p:SqlQuery stringValue="delete from tokenstore where userid=${request.http.parameter.userid};"/>
                                    </L7p:JdbcQuery>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHA+VXNlciBJRDogJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnVzZXJpZH08L3A+DQo8cD5Ub2tlbiBTdWNjZXNmdWxseSBEZWxldGVkPC9wPg=="/>
                                    <L7p:VariableToSet stringValue="message"/>
                                    </L7p:SetVariable>
                                </wsp:All>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHA+VXNlciBJRDogJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnVzZXJpZH08L3A+DQo8cD5FcnJvciBEZWxldGluZyBUb2tlbjwvcD4="/>
                                    <L7p:VariableToSet stringValue="message"/>
                                </L7p:SetVariable>
                            </wsp:OneOrMore>
                            <L7p:HardcodedResponse>
                                <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="200"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:AssertionComment>
                                <L7p:Base64ResponseBody stringValue="JHt3ZWJzaXRlX3RvcH0KJHttZXNzYWdlfQoke3dlYnNpdGVfYm90dG9tfQ=="/>
                                <L7p:EarlyResponse booleanValue="true"/>
                                <L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/>
                            </L7p:HardcodedResponse>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <L7p:ExportVariables>
                        <L7p:ExportedVars stringArrayValue="included">
                            <L7p:item stringValue="issueToken"/>
                        </L7p:ExportedVars>
                    </L7p:ExportVariables>
                </wsp:All>
            </wsp:Policy>
        </IncludedPolicyReference>
        <IncludedPolicyReference RefType="com.l7tech.console.policy.exporter.IncludedPolicyReference" guid="220d2644-8248-4548-9486-acadfee17294" included="true" name="Evaluate Retry Policy" soap="false" type="INCLUDE_FRAGMENT">
            <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
                <wsp:All wsp:Usage="Required">
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="Policy Fragment: Evaluate Retry Policy"/>
                    </L7p:AuditDetailAssertion>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="Mw=="/>
                        <L7p:DataType variableDataType="int"/>
                        <L7p:VariableToSet stringValue="max_retries"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="ZmFsc2U="/>
                        <L7p:VariableToSet stringValue="retries_exceeded"/>
                    </L7p:SetVariable>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:CacheLookup>
                                <L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}"/>
                                <L7p:CacheId stringValue="retryCache"/>
                                <L7p:ContentTypeOverride stringValue=""/>
                                <L7p:OtherTargetMessageVariable stringValue="retryMessage"/>
                                <L7p:Target target="OTHER"/>
                            </L7p:CacheLookup>
                            <L7p:ResponseXpathAssertion>
                                <L7p:VariablePrefix stringValue="count"/>
                                <L7p:XmlMsgSrc stringValue="retryMessage"/>
                                <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/count"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                </L7p:XpathExpression>
                            </L7p:ResponseXpathAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="dHJ1ZQ=="/>
                                <L7p:VariableToSet stringValue="retries_exceeded"/>
                            </L7p:SetVariable>
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${count.result}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="int"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Operator operator="LT"/>
                                    <L7p:RightValue stringValue="${max_retries}"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="ZmFsc2U="/>
                                <L7p:VariableToSet stringValue="retries_exceeded"/>
                            </L7p:SetVariable>
                            <L7p:ResponseXpathAssertion>
                                <L7p:VariablePrefix stringValue="math"/>
                                <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="$count.result + 1"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                </L7p:XpathExpression>
                            </L7p:ResponseXpathAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PGNvdW50PiR7bWF0aC5yZXN1bHR9PC9jb3VudD4="/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="retryMessage"/>
                            </L7p:SetVariable>
                            <L7p:CacheStorage>
                                <L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}"/>
                                <L7p:CacheId stringValue="retryCache"/>
                                <L7p:MaxEntries stringValue="1000000"/>
                                <L7p:OtherTargetMessageVariable stringValue="retryMessage"/>
                                <L7p:Target target="OTHER"/>
                            </L7p:CacheStorage>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${retries_exceeded}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="false"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PGNvdW50PjE8L2NvdW50Pg=="/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="retryMessage"/>
                            </L7p:SetVariable>
                            <L7p:CacheStorage>
                                <L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}"/>
                                <L7p:CacheId stringValue="retryCache"/>
                                <L7p:MaxEntries stringValue="1000000"/>
                                <L7p:OtherTargetMessageVariable stringValue="retryMessage"/>
                                <L7p:Target target="OTHER"/>
                            </L7p:CacheStorage>
                        </wsp:All>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="dHJ1ZQ=="/>
                            <L7p:VariableToSet stringValue="retries_exceeded"/>
                        </L7p:SetVariable>
                    </wsp:OneOrMore>
                    <L7p:ExportVariables>
                        <L7p:ExportedVars stringArrayValue="included">
                            <L7p:item stringValue="retries_exceeded"/>
                        </L7p:ExportedVars>
                    </L7p:ExportVariables>
                </wsp:All>
            </wsp:Policy>
        </IncludedPolicyReference>
    </exp:References>
    <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
        <wsp:All wsp:Usage="Required">
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="NWVlZDg2OGUtN2FkMC00MTcyLTg4ZjItNzA0YmNmNzhiNjFl"/>
                <L7p:VariableToSet stringValue="client_id"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="MjA1NGU0ZDctNzdmMi00NmM5LWJjNGQtMTFhNDcyNTVhNmVj"/>
                <L7p:VariableToSet stringValue="client_secret"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="b3Blbmlk"/>
                <L7p:VariableToSet stringValue="scope"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="Y29kZQ=="/>
                <L7p:VariableToSet stringValue="response_type"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="aHR0cHM6Ly9leHBsb3JlLmxheWVyNy5jYTo4NDQzL2FsbGRhdGE/YXV0aD1kb25l"/>
                <L7p:VariableToSet stringValue="redirect_uri"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="cGFnZQ=="/>
                <L7p:VariableToSet stringValue="display"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="bG9naW4="/>
                <L7p:VariableToSet stringValue="prompt"/>
            </L7p:SetVariable>
            <wsp:OneOrMore L7p:Enabled="false" wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.method}"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="GET"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="mag393bcb93-82ad-4b55-8333-1119f607a"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="mag OTK Require OAuth 2.0 Token"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="cache_lifetime"/>
                                <L7p:value stringValue="30"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="given_access_token"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="onetime"/>
                                <L7p:value stringValue="false"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="scope_fail"/>
                                <L7p:value stringValue="false"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="scope_required"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:HardcodedResponse>
                        <L7p:Base64ResponseBody stringValue="U3VjY2Vzcw=="/>
                        <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                    </L7p:HardcodedResponse>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="// Check for existing Access Token"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.method}"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="POST"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="REQUEST: ${request.mainpart}"/>
                        <L7p:Enabled booleanValue="false"/>
                        <L7p:Level stringValue="WARNING"/>
                    </L7p:AuditDetailAssertion>
                    <L7p:HttpRoutingAssertion>
                        <L7p:FailOnErrorStatus booleanValue="false"/>
                        <L7p:ProtectedServiceUrl stringValue="https://explore.layer7.ca:8443/mag/auth/oauth/v2/authorize"/>
                        <L7p:ProxyPassword stringValueNull="null"/>
                        <L7p:ProxyUsername stringValueNull="null"/>
                        <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                </L7p:item>
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:RequestHeaderRules>
                        <L7p:RequestParamRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included"/>
                        </L7p:RequestParamRules>
                        <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:ResponseHeaderRules>
                        <L7p:SamlAssertionVersion intValue="2"/>
                    </L7p:HttpRoutingAssertion>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValueReference="inline"><![CDATA[CODE: ${httpRouting.reasonCode}
LOC: ${response.http.header.location}
RESP: ${response.mainpart}]]></L7p:Detail>
                        <L7p:Level stringValue="WARNING"/>
                    </L7p:AuditDetailAssertion>
                    <L7p:Split>
                        <L7p:InputVariable stringValue="response.http.header.location"/>
                        <L7p:OutputVariable stringValue="respParams"/>
                        <L7p:SplitPattern stringValue="\?|&amp;"/>
                    </L7p:Split>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue=""/>
                        <L7p:VariableToSet stringValue="code"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue=""/>
                        <L7p:VariableToSet stringValue="state"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue=""/>
                        <L7p:VariableToSet stringValue="auth"/>
                    </L7p:SetVariable>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="RESPPARAMS: ${respParams}"/>
                        <L7p:Level stringValue="WARNING"/>
                    </L7p:AuditDetailAssertion>
                    <L7p:ForEachLoop L7p:Usage="Required" iterationLimit="10" loopVariable="respParams" variablePrefix="itr">
                        <wsp:OneOrMore wsp:Usage="Required">
                            <wsp:All wsp:Usage="Required">
                                <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:OtherTargetMessageVariable stringValue="itr.current"/>
                                    <L7p:Regex stringValue="code="/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                </L7p:Regex>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtpdHIuY3VycmVudH0="/>
                                    <L7p:VariableToSet stringValue="code"/>
                                </L7p:SetVariable>
                                <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:OtherTargetMessageVariable stringValue="code"/>
                                    <L7p:Regex stringValue="code="/>
                                    <L7p:Replace booleanValue="true"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                </L7p:Regex>
                            </wsp:All>
                            <wsp:All wsp:Usage="Required">
                                <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:OtherTargetMessageVariable stringValue="itr.current"/>
                                    <L7p:Regex stringValue="state="/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                </L7p:Regex>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtpdHIuY3VycmVudH0="/>
                                    <L7p:VariableToSet stringValue="state"/>
                                </L7p:SetVariable>
                                <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:OtherTargetMessageVariable stringValue="state"/>
                                    <L7p:Regex stringValue="state="/>
                                    <L7p:Replace booleanValue="true"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                </L7p:Regex>
                            </wsp:All>
                            <wsp:All wsp:Usage="Required">
                                <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:OtherTargetMessageVariable stringValue="itr.current"/>
                                    <L7p:Regex stringValue="auth="/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                </L7p:Regex>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtpdHIuY3VycmVudH0="/>
                                    <L7p:VariableToSet stringValue="auth"/>
                                </L7p:SetVariable>
                                <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:OtherTargetMessageVariable stringValue="auth"/>
                                    <L7p:Regex stringValue="auth="/>
                                    <L7p:Replace booleanValue="true"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                </L7p:Regex>
                            </wsp:All>
                            <L7p:TrueAssertion/>
                        </wsp:OneOrMore>
                    </L7p:ForEachLoop>
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${state}"/>
                            <L7p:Expression2 stringValue="call"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="call"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${auth}"/>
                            <L7p:Expression2 stringValue="done"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="done"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:ComparisonAssertion>
                            <L7p:Expression1 stringValue="${code}"/>
                            <L7p:Expression2 stringValue=""/>
                            <L7p:Negate booleanValue="true"/>
                            <L7p:Operator operator="EMPTY"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <wsp:OneOrMore wsp:Usage="Required">
                            <wsp:All wsp:Usage="Required">
                                <L7p:WssReplayProtection>
                                    <L7p:CustomExpiryTime intValue="300000"/>
                                    <L7p:CustomIdentifierVariable stringValue="code"/>
                                    <L7p:CustomProtection booleanValue="true"/>
                                    <L7p:CustomScope stringValue="myendpoiint"/>
                                    <L7p:Enabled booleanValue="false"/>
                                </L7p:WssReplayProtection>
                                <L7p:EncodeDecode>
                                    <L7p:SourceVariableName stringValue="redirect_uri"/>
                                    <L7p:TargetDataType variableDataType="string"/>
                                    <L7p:TargetVariableName stringValue="redirect_uri_encoded"/>
                                    <L7p:TransformType transformType="URL_ENCODE"/>
                                </L7p:EncodeDecode>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="cmVkaXJlY3RfdXJpPSR7cmVkaXJlY3RfdXJpX2VuY29kZWR9JmNvZGU9JHtjb2RlfSZncmFudF90eXBlPWF1dGhvcml6YXRpb25fY29kZSZzdGF0ZT0ke2dhdGV3YXkudGltZS55eXl5TU1kZEhIbW1zc1NTU30mY2xpZW50X2lkPSR7Y2xpZW50X2lkfSZjbGllbnRfc2VjcmV0PSR7Y2xpZW50X3NlY3JldH0="/>
                                    <L7p:ContentType stringValue="application/x-www-form-urlencoded"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="toServer"/>
                                </L7p:SetVariable>
                                <L7p:HttpRoutingAssertion>
                                    <L7p:FailOnErrorStatus booleanValue="false"/>
                                    <L7p:HttpMethod httpMethod="POST"/>
                                    <L7p:ProtectedServiceUrl stringValue="https://explore.layer7.ca:8443/mag/auth/oauth/v2/token"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestMsgSrc stringValue="toServer"/>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="authServerResponse"/>
                                    <L7p:SamlAssertionVersion intValue="2"/>
                                </L7p:HttpRoutingAssertion>
                                <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:CaptureVar stringValue="access_token"/>
                                    <L7p:OtherTargetMessageVariable stringValue="authServerResponse"/>
                                    <L7p:Regex stringValue="\&quot;access_token\&quot;:\&quot;([^&quot;]{1,60})\&quot;"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                </L7p:Regex>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHthY2Nlc3NfdG9rZW5bMV19"/>
                                    <L7p:VariableToSet stringValue="access_token"/>
                                </L7p:SetVariable>
                                <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:CaptureVar stringValue="refresh_token"/>

                                    <L7p:OtherTargetMessageVariable stringValue="authServerResponse"/>
                                    <L7p:Regex stringValue="\&quot;refresh_token\&quot;:\&quot;([^&quot;]{1,60})\&quot;"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtyZWZyZXNoX3Rva2VuWzFdfQ=="/>
                                    <L7p:VariableToSet stringValue="refresh_token"/>
                                    </L7p:SetVariable>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PGJyLz4NCjxoci8+DQo8cD48Yj5SZWZyZXNoPC9iPjwvcD4NCjxwPlVzZSB0aGUgcmVmcmVzaF90b2tlbiB0byByZXF1ZXN0IGEgbmV3IGFjY2Vzc190b2tlbiBhbmQgcmVmcmVzaF90b2tlbjxici8+KGl0IGNhbm5vdCBiZSBleGNoYW5nZWQgZm9yIGEgbmV3IGlkX3Rva2VuKTwvcD4NCjxwPlRoZSBjbGllbnQgbmVlZHMgdG8gaW5jbHVkZSB0aGUgcGFyYW1ldGVycyBsaXN0ZWQgYmVsb3cuIEl0IGFsc28gbmVlZHMgdG8gYXV0aGVudGljYXRlIGl0c2VsZiB1c2luZyBjbGllbnRfaWQgYW5kIGNsaWVudF9zZWNyZXQuPC9wPg0KPGZvcm0gYWN0aW9uPSIke2xvY2F0aW9uX2FwcH0iIG1ldGhvZD0iUE9TVCI+DQogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhdGUiIHZhbHVlPSJyZWZyZXNoIj48YnIvPg0KPHRhYmxlPg0KPHRyPiAgICANCjx0ZD5yZWZyZXNoX3Rva2VuPC90ZD48dGQ+PGlucHV0IHR5cGU9InRleHQiIG5hbWU9InJlZnJlc2hfdG9rZW4iIHZhbHVlPSIke3JlZnJlc2hfdG9rZW59IiByZWFkb25seT0icmVhZG9ubHkiPjwvdGQ+DQo8L3RyPg0KPHRyPg0KPHRkPmdyYW50X3R5cGU8L3RkPjx0ZD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0iZ3JhbnRfdHlwZSIgdmFsdWU9InJlZnJlc2hfdG9rZW4iIHJlYWRvbmx5PSJyZWFkb25seSI+PC90ZD4NCjwvdHI+DQo8dHI+DQo8dGQ+c2NvcGU8L3RkPjx0ZD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0ic2NvcGUiIHZhbHVlPSIke3Njb3BlfSIgcmVhZG9ubHk9InJlYWRvbmx5Ij48L3RkPg0KPC90cj4NCjx0cj4NCjx0ZD5Vc2UgdGhlIHJlZnJlc2hfdG9rZW48L3RkPjx0ZD48aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iUmVmcmVzaCI+PC90ZD4NCjwvdHI+DQo8L3RhYmxlPg0KPC9mb3JtPg0KPGJyLz4="/>
                                    <L7p:VariableToSet stringValue="refresh_token_display"/>
                                    </L7p:SetVariable>
                                    </wsp:All>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="refresh_token_display"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Check for a refresh_token"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:OneOrMore>
                                <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:CaptureVar stringValue="id_token"/>

                                    <L7p:OtherTargetMessageVariable stringValue="authServerResponse"/>
                                    <L7p:Regex stringValue="\&quot;id_token\&quot;:\&quot;([^&quot;]+)\&quot;"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtpZF90b2tlblsxXX0="/>
                                    <L7p:VariableToSet stringValue="id_token"/>
                                    </L7p:SetVariable>
                                    <L7p:JwtDecode>
                                    <L7p:AlgorithmSecretLocation intValue="4"/>
                                    <L7p:AlgorithmSecretValue stringValue="${client_secret_bcp}"/>
                                    <L7p:IncomingToken stringValue="${id_token}"/>
                                    <L7p:OutputVariable stringValue="jwt.payload"/>
                                    </L7p:JwtDecode>
                                    <L7p:IDTokenDecode>
                                    <L7p:Payload stringValue="${jwt.payload}"/>
                                    </L7p:IDTokenDecode>
                                    </wsp:All>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHA+PGI+Tm8gSURfVE9LRU4gd2FzIGlzc3VlZDwvYj4uIFRoZXJlIGFyZSBzZXZlcmFsIHBvc3NpYmxlIHJlYXNvbnMgZm9yIHRoYXQ6PC9wPg0KPG9sPg0KPGxpPnRoZSB1c2VyIGRpZCBub3QgZ3JhbnQgaXQ8L2xpPg0KPGxpPnRoZSByZXF1ZXN0ZWQgU0NPUEUgZGlkIG5vdCBpbmNsdWRlICdvcGVuaWQnPC9saT4NCjxsaT50aGUgY2xpZW50IHdhcyBub3QgcmVnaXN0ZXJlZCBhcyBhIHZhbGlkIE9wZW5JRCBDb25uZWN0IGNsaWVudDwvbGk+DQo8bGk+YSByZWZyZXNoX3Rva2VuIHdhcyB1c2VkIHRvIHJlcXVlc3QgbmV3IHRva2VucyBidXQgYSByZWZyZXNoX3Rva2VuIGNhbm5vdCBiZSB1c2VkIHRvIHJlcXVlc3QgYSBuZXcgaWRfdG9rZW48L2xpPg0KPC9vbD4="/>
                                    <L7p:VariableToSet stringValue="idTokenIssued"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Check for an id_token"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:OneOrMore>
                                <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="c3VjY2Vzcwoke2FjY2Vzc190b2tlbn0KJHtpZF90b2tlbn0="/>
                                    <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                                </L7p:HardcodedResponse>
                            </wsp:All>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="JHtodG1sVGVtcGxhdGVUb3B9CjxwPlNvcnJ5LCBidXQgdGhlIGF1dGhvcml6YXRpb25fY29kZSBoYXMgYmVlbiBwcm9jZXNzZWQgYWxyZWFkeS48L3A+CjxwPklmIHlvdSB3YW50IHRvIHJlcXVlc3QgYSBuZXcgb25lLCBjbGljayBoZXJlOiA8YSBocmVmPSIke2xvY2F0aW9uX2FwcH0iPkFHQUlOPC9hPjwvcD4KJHtodG1sVGVtcGxhdGVCb3R0b219"/>
                                <L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/>
                            </L7p:HardcodedResponse>
                        </wsp:OneOrMore>
                        <L7p:assertionComment>
                            <L7p:Properties mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="GRANTED"/>
                                </L7p:entry>
                            </L7p:Properties>
                        </L7p:assertionComment>
                    </wsp:All>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="// Handle User Credentials from login page"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="Y2FsbA=="/>
                        <L7p:VariableToSet stringValue="state"/>
                    </L7p:SetVariable>
                    <L7p:EncodeDecode>
                        <L7p:SourceVariableName stringValue="client_id"/>
                        <L7p:TargetDataType variableDataType="string"/>
                        <L7p:TargetVariableName stringValue="client_id"/>
                        <L7p:TransformType transformType="URL_ENCODE"/>
                    </L7p:EncodeDecode>
                    <L7p:EncodeDecode>
                        <L7p:SourceVariableName stringValue="scope"/>
                        <L7p:TargetDataType variableDataType="string"/>
                        <L7p:TargetVariableName stringValue="scope"/>
                        <L7p:TransformType transformType="URL_ENCODE"/>
                    </L7p:EncodeDecode>
                    <L7p:EncodeDecode>
                        <L7p:SourceVariableName stringValue="response_type"/>
                        <L7p:TargetDataType variableDataType="string"/>
                        <L7p:TargetVariableName stringValue="response_type"/>
                        <L7p:TransformType transformType="URL_ENCODE"/>
                    </L7p:EncodeDecode>
                    <L7p:EncodeDecode>
                        <L7p:SourceVariableName stringValue="redirect_uri"/>
                        <L7p:TargetDataType variableDataType="string"/>
                        <L7p:TargetVariableName stringValue="redirect_uri"/>
                        <L7p:TransformType transformType="URL_ENCODE"/>
                    </L7p:EncodeDecode>
                    <L7p:EncodeDecode>
                        <L7p:SourceVariableName stringValue="display"/>
                        <L7p:TargetDataType variableDataType="string"/>
                        <L7p:TargetVariableName stringValue="display"/>
                        <L7p:TransformType transformType="URL_ENCODE"/>
                    </L7p:EncodeDecode>
                    <L7p:EncodeDecode>
                        <L7p:SourceVariableName stringValue="prompt"/>
                        <L7p:TargetDataType variableDataType="string"/>
                        <L7p:TargetVariableName stringValue="prompt"/>
                        <L7p:TransformType transformType="URL_ENCODE"/>
                    </L7p:EncodeDecode>
                    <L7p:EncodeDecode>
                        <L7p:SourceVariableName stringValue="state"/>
                        <L7p:TargetDataType variableDataType="string"/>
                        <L7p:TargetVariableName stringValue="state"/>
                        <L7p:TransformType transformType="URL_ENCODE"/>
                    </L7p:EncodeDecode>
                    <L7p:EncodeDecode>
                        <L7p:SourceVariableName stringValue="gateway.time.HHssmmSSS"/>
                        <L7p:TargetDataType variableDataType="string"/>
                        <L7p:TargetVariableName stringValue="nonce"/>
                        <L7p:TransformType transformType="URL_ENCODE"/>
                    </L7p:EncodeDecode>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="Y2xpZW50X2lkPSR7Y2xpZW50X2lkfSZyZXNwb25zZV90eXBlPSR7cmVzcG9uc2VfdHlwZX0mc2NvcGU9JHtzY29wZX0mcmVkaXJlY3RfdXJpPSR7cmVkaXJlY3RfdXJpfSZkaXNwbGF5PSR7ZGlzcGxheX0mcHJvbXB0PSR7cHJvbXB0fSZzdGF0ZT0ke3N0YXRlfSZub25jZT0ke25vbmNlfQ=="/>
                        <L7p:ContentType stringValue="application/x-www-form-urlencoded"/>
                        <L7p:DataType variableDataType="message"/>
                        <L7p:VariableToSet stringValue="authRequestParameters"/>
                    </L7p:SetVariable>
                    <L7p:HttpRoutingAssertion>
                        <L7p:FailOnErrorStatus booleanValue="false"/>
                        <L7p:ProtectedServiceUrl stringValue="https://explore.layer7.ca:8443/mag/auth/oauth/v2/authorize"/>
                        <L7p:ProxyPassword stringValueNull="null"/>
                        <L7p:ProxyUsername stringValueNull="null"/>
                        <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                </L7p:item>
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:RequestHeaderRules>
                        <L7p:RequestMsgSrc stringValue="authRequestParameters"/>
                        <L7p:RequestParamRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included"/>
                        </L7p:RequestParamRules>
                        <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:ResponseHeaderRules>
                        <L7p:SamlAssertionVersion intValue="2"/>
                    </L7p:HttpRoutingAssertion>
                    <L7p:Regex>
                        <L7p:AutoTarget booleanValue="false"/>
                        <L7p:Regex stringValue="https://explore.layer7.ca:8443/mag/auth/oauth/v2/authorize"/>
                        <L7p:Replace booleanValue="true"/>
                        <L7p:Replacement stringValue="https://explore.layer7.ca:8443/alldata"/>
                        <L7p:Target target="RESPONSE"/>
                    </L7p:Regex>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="// Initiate authentication to request new access token"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
            </wsp:OneOrMore>
            <L7p:Include>
                <L7p:PolicyGuid stringValue="75d640da-2c2d-4880-810d-d1696e4c078a"/>
            </L7p:Include>
        </wsp:All>
    </wsp:Policy>
</exp:Export>
